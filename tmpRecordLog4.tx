2023-07-14T10:50:35.410Z	INFO	hooks/loader.go:595	üê∞ Keploy:keploy initialized and probes added to the kernel.
2023-07-14T10:50:35.411Z	DEBUG	hooks/loader.go:606	üê∞ Keploy:	{"Keploy Inode number": 4026531836}
2023-07-14T10:50:35.411Z	DEBUG	hooks/loader.go:249	üê∞ Keploy:Sending keploy pid to kernel	{"pid": 125703}
2023-07-14T10:50:35.411Z	DEBUG	hooks/loader.go:609	üê∞ Keploy:Keploy Pid sent successfully...
2023-07-14T10:50:36.697Z	DEBUG	proxy/proxy.go:185	üê∞ Keploy:Running Dns Server in Test mode...
2023-07-14T10:50:36.697Z	INFO	proxy/proxy.go:186	üê∞ Keploy:Keploy has hijacked the DNS resolution mechanism, your application may misbehave in keploy test mode if you have provided wrong domain name in your application code.
2023-07-14T10:50:36.698Z	DEBUG	proxy/proxy.go:194	üê∞ Keploy:Proxy IPv4:Port 2887718541:16789
2023-07-14T10:50:36.698Z	DEBUG	proxy/proxy.go:195	üê∞ Keploy:Proxy IPV6:Port Addr [0 0 0 1]:16789
2023-07-14T10:50:36.698Z	INFO	proxy/proxy.go:196	üê∞ Keploy:Proxy started at port:16789
name for the file testReports
name for the file test-suite-0
2023-07-14T10:50:36.698Z	DEBUG	test/test.go:75	the session indices are : 	{"": ["testReports", "test-suite-0"]}
[ home ubuntu keploy-v2 keploy Keploy testReports tests]
2023-07-14T10:50:36.698Z	DEBUG	yaml/yaml.go:212	no tests are recorded for the session	{"index": "testReports"}
the tests are:  [0xc0022bdc80 0xc0022bd980]
2023-07-14T10:50:36.700Z	DEBUG	proxy/proxy.go:313	üê∞ Keploy:	{"ProxyAddress4": "172.31.22.141"}
2023-07-14T10:50:36.700Z	DEBUG	proxy/proxy.go:316	üê∞ Keploy:	{"ProxyAddress6": "::1"}
2023-07-14T10:50:36.700Z	DEBUG	proxy/proxy.go:325	üê∞ Keploy:Proxy server is listening on :[::]:16789
2023-07-14T10:50:36.700Z	DEBUG	proxy/proxy.go:326	üê∞ Keploy:Proxy will accept both ipv4 and ipv6 connections	{"Ipv4": "172.31.22.141", "Ipv6": "::1"}
2023-07-14T10:50:36.700Z	DEBUG	proxy/proxy.go:363	üê∞ Keploy:	{"ProxyAddress in dns server": "172.31.22.141:16789"}
2023-07-14T10:50:36.700Z	INFO	proxy/proxy.go:380	üê∞ Keploy:starting DNS server at addr:172.31.22.141:16789
the mocks are:  [0xc0001d3b80 0xc0001d3c20 0xc0001d3cc0] [0xc00028ef00 0xc00028efa0]
2023-07-14T10:50:43.702Z	DEBUG	hooks/launch.go:101	üê∞ Keploy:Running user application on Linux
2023-07-14T10:50:43.702Z	DEBUG	hooks/launch.go:109	üê∞ Keploy:Waiting for any error from user application

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.1.0)

2023-07-14T10:50:46.074Z  INFO 126528 --- [           main] b.s.d.m.SpringBootDataMongodbApplication : Starting SpringBootDataMongodbApplication v0.0.1-SNAPSHOT using Java 17.0.7 with PID 126528 (/home/ubuntu/java-worksapce/spring-boot-data-mongodb/target/spring-boot-data-mongodb-0.0.1-SNAPSHOT.jar started by root in /home/ubuntu/keploy-v2/keploy)
2023-07-14T10:50:46.092Z  INFO 126528 --- [           main] b.s.d.m.SpringBootDataMongodbApplication : No active profile set, falling back to 1 default profile: "default"
2023-07-14T10:50:47.804Z  INFO 126528 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2023-07-14T10:50:47.923Z  INFO 126528 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 110 ms. Found 1 MongoDB repository interfaces.
2023-07-14T10:50:48.702Z	DEBUG	hooks/launch.go:111	üê∞ Keploy:After running user application
2023-07-14T10:50:48.703Z	DEBUG	hooks/launch.go:124	üê∞ Keploy:Now setting app pids
üê∞ Keploy: Output of pidof [49 50 54 53 50 56 10]
üê∞ Keploy: Output of pidof 126528
Pid of application: 126528
2023-07-14T10:50:48.728Z	DEBUG	hooks/launch.go:134	üê∞ Keploy:PID of application:	{"App pid": 126528}
2023-07-14T10:50:48.728Z	INFO	hooks/launch.go:145	üê∞ Keploy:User application started successfully
2023-07-14T10:50:48.729Z	INFO	test/test.go:154	üê∞ Keploy:	{"no of test cases": 2}
2023-07-14T10:50:48.729Z	DEBUG	test/test.go:169	üê∞ Keploy:Before setting deps.... during testing...
2023-07-14T10:50:48.729Z	DEBUG	test/test.go:171	üê∞ Keploy:Before simulating the request	{"Test case": {"version":"api.keploy.io/v1beta2","kind":"Http","name":"test-1","created":1689323010,"updated":0,"captured":0,"http_req":{"method":"POST","proto_major":1,"proto_minor":1,"url":"http://localhost:8080/api/tutorials","url_params":null,"header":{"Accept":"*/*","Content-Length":"94","Content-Type":"application/json","User-Agent":"curl/7.81.0"},"body":"{\n  \"title\": \"New Tutorial\",\n  \"description\": \"This is a new tutorial\",\n  \"published\": false\n}","body_type":"","binary":"","form":null},"http_resp":{"status_code":201,"header":{"Content-Type":"application/json","Date":"Fri, 14 Jul 2023 08:23:29 GMT","Vary":"Origin,Access-Control-Request-Method,Access-Control-Request-Headers"},"body":"{\"id\":\"64b10601c8e1cd3dcbc57881\",\"title\":\"New Tutorial\",\"description\":\"This is a new tutorial\",\"published\":false}","body_type":"","status_message":"","proto_major":0,"proto_minor":0,"binary":""},"all_keys":null,"anchors":null,"noise":[],"mocks":null,"type":""}}
2023-07-14T10:50:49.045Z  INFO 126528 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2023-07-14T10:50:49.065Z  INFO 126528 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2023-07-14T10:50:49.066Z  INFO 126528 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.8]
2023-07-14T10:50:49.253Z  INFO 126528 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2023-07-14T10:50:49.262Z  INFO 126528 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2979 ms
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 54226, "Time": 1689331849}
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:50:49.694Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 54226}
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 54224, "Time": 1689331849}
2023-07-14T10:50:49.694Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:50:49.694Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 54224}
2023-07-14T10:50:49.703Z  INFO 126528 --- [           main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.9.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.19.0-1028-aws"}, "platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, CollectionCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.client.model.mql.ExpressionCodecProvider@5c08c46a, com.mongodb.Jep395RecordCodecProvider@4cf8b2dc]}, loggerSettings=LoggerSettings{maxDocumentLength=1000}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=null}
read bytes:  317 , err:  <nil>
2023-07-14T10:50:49.713Z	DEBUG	proxy/proxy.go:615	the clientConnId: 34
into processing mongo. clientConnId:  34
into test mode. clientConnId:  34
into decode mongo. clientConnId:  34
2023-07-14T10:50:49.713Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 34 and the time delay: 1.49¬µs	{"clientConnId": 34}
2023-07-14T10:50:49.713Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 1 0 OP_QUERY}	{"clientConnId": 34}
2023-07-14T10:50:49.713Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 34}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  34
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  34
the recieved request:   header: &{317 1 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  34
2023-07-14T10:50:49.713Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 34}
2023-07-14T10:50:49.714Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331849	{"clientConnId": 34}
2023-07-14T10:50:49.714Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331849"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 34}
2023-07-14T10:50:49.714Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime â(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 34, "clientconnid": 34}
an iteration of a mongo request lifecycle is completed. clientconnid: 34
read bytes:  317 , err:  <nil>
2023-07-14T10:50:49.716Z	DEBUG	proxy/proxy.go:615	the clientConnId: 19
into processing mongo. clientConnId:  19
into test mode. clientConnId:  19
into decode mongo. clientConnId:  19
2023-07-14T10:50:49.716Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 19 and the time delay: 1.25¬µs	{"clientConnId": 19}
2023-07-14T10:50:49.716Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 2 0 OP_QUERY}	{"clientConnId": 19}
2023-07-14T10:50:49.716Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 19}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  19
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{317 2 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  19
2023-07-14T10:50:49.716Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 19}
2023-07-14T10:50:49.716Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331849	{"clientConnId": 19}
2023-07-14T10:50:49.716Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331849"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 19}
2023-07-14T10:50:49.716Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime â(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 19, "clientconnid": 19}
an iteration of a mongo request lifecycle is completed. clientconnid: 19
2023-07-14T10:50:49.754Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=56731020}
read bytes:  197 , err:  <nil>
  the clientConnId:  34
2023-07-14T10:50:49.785Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 34 and the time delay: 71.409328ms	{"clientConnId": 34}
2023-07-14T10:50:49.785Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 3 0 OP_MSG}	{"clientConnId": 34}
2023-07-14T10:50:49.785Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 34}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  34
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  34
the recieved request:   header: &{197 3 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 3 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 3 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:50:49.785Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 34}
2023-07-14T10:50:49.785Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 34, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 34
2023-07-14T10:50:51.142Z  INFO 126528 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2023-07-14T10:50:51.176Z  INFO 126528 --- [           main] b.s.d.m.SpringBootDataMongodbApplication : Started SpringBootDataMongodbApplication in 6.251 seconds (process running for 7.469)
2023-07-14T10:50:58.921Z	DEBUG	connection/tracker.go:84	üê∞ Keploy:Got a data event from eBPF	{"Direction": 1, "current event size": 304}
2023-07-14T10:50:58.993Z  INFO 126528 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2023-07-14T10:50:58.994Z  INFO 126528 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2023-07-14T10:50:58.996Z  INFO 126528 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2023-07-14T10:50:59.365Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:50:59.365Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:50:59.365Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 48102, "Time": 1689331859}
2023-07-14T10:50:59.365Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:50:59.365Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 48102}
read bytes:  317 , err:  <nil>
2023-07-14T10:50:59.367Z	DEBUG	proxy/proxy.go:615	the clientConnId: 7
into processing mongo. clientConnId:  7
into test mode. clientConnId:  7
into decode mongo. clientConnId:  7
2023-07-14T10:50:59.367Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 7 and the time delay: 900ns	{"clientConnId": 7}
2023-07-14T10:50:59.367Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 4 0 OP_QUERY}	{"clientConnId": 7}
2023-07-14T10:50:59.367Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 7}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  7
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  7
the recieved request:   header: &{317 4 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  7
2023-07-14T10:50:59.368Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 7}
2023-07-14T10:50:59.368Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331859	{"clientConnId": 7}
2023-07-14T10:50:59.368Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331859"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 7}
2023-07-14T10:50:59.368Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime ì(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 7, "clientconnid": 7}
an iteration of a mongo request lifecycle is completed. clientconnid: 7
read bytes:  288 , err:  <nil>
  the clientConnId:  7
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 7 and the time delay: 28.417881ms	{"clientConnId": 7}
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {288 5 0 OP_MSG}	{"clientConnId": 7}
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"insert":"tutorials","ordered":true,"$db":"bezkoder_db","lsid":{"id":{"$binary":{"base64":"Y1gwgzagTrWYMjc5pKAw0A==","subType":"04"}}}} }, { SectionSingle identifier: documents, msgs: [{"_id":{"$oid":"64b1289302de126c3184f186"},"title":"New Tutorial","description":"This is a new tutorial","published":false,"_class":"com.bezkoder.spring.data.mongodb.model.Tutorial"}] }], checksum: 0 }	{"clientConnId": 7}
the request buffer:            ›       ^   insert 
   tutorials ordered $db    bezkoder_db lsid    id    cX0É6†Nµò279§†0–  ¨   documents û   _id d±(ìﬁl1ÑÒÜtitle    New Tutorial description    This is a new tutorial published  _class 0   com.bezkoder.spring.data.mongodb.model.Tutorial    clientConnId:  7
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"insert":"tutorials","ordered":true,"$db":"bezkoder_db","lsid":{"id":{"$binary":{"base64":"Y1gwgzagTrWYMjc5pKAw0A==","subType":"04"}}}} }, { SectionSingle identifier: documents, msgs: [{"_id":{"$oid":"64b1289302de126c3184f186"},"title":"New Tutorial","description":"This is a new tutorial","published":false,"_class":"com.bezkoder.spring.data.mongodb.model.Tutorial"}] }], checksum: 0 }
the request opmg is isMaster? : false 
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"insert":"tutorials","ordered":true,"$db":"bezkoder_db","lsid":{"id":{"$binary":{"base64":"l9rYpESIQkSsaf7uo8Dg7w==","subType":"04"}}}} }
 and actual: { SectionSingle msg: {"insert":"tutorials","ordered":true,"$db":"bezkoder_db","lsid":{"id":{"$binary":{"base64":"Y1gwgzagTrWYMjc5pKAw0A==","subType":"04"}}}} }	{"clientConnId": 7}
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 7, "expected": {"$db":"bezkoder_db","insert":"tutorials","lsid":{"id":{"Subtype":4,"Data":"l9rYpESIQkSsaf7uo8Dg7w=="}},"ordered":true}, "actual": {"$db":"bezkoder_db","insert":"tutorials","lsid":{"id":{"Subtype":4,"Data":"Y1gwgzagTrWYMjc5pKAw0A=="}},"ordered":true}}
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/mongoparser.go:1073	the diff is: [map[lsid].map[id]: {4 [151 218 216 164 68 136 66 68 172 105 254 238 163 192 224 239]} != {4 [99 88 48 131 54 160 78 181 152 50 55 57 164 160 48 208]}], len(diff): 1. bool: true	{"clientConnId": 7}
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/mongoparser.go:642	the sections are not matched. 	{"clientConnId": 7, "expected": "{ SectionSingle msg: {\"insert\":\"tutorials\",\"ordered\":true,\"$db\":\"bezkoder_db\",\"lsid\":{\"id\":{\"$binary\":{\"base64\":\"l9rYpESIQkSsaf7uo8Dg7w==\",\"subType\":\"04\"}}}} }", "actual": "{ SectionSingle msg: {\"insert\":\"tutorials\",\"ordered\":true,\"$db\":\"bezkoder_db\",\"lsid\":{\"id\":{\"$binary\":{\"base64\":\"Y1gwgzagTrWYMjc5pKAw0A==\",\"subType\":\"04\"}}}} }"}
2023-07-14T10:50:59.396Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"insert":"tutorials","ordered":true,"$db":"bezkoder_db","lsid":{"id":{"$binary":{"base64":"l9rYpESIQkSsaf7uo8Dg7w==","subType":"04"}}}} }
 and actual: { SectionSingle msg: {"insert":"tutorials","ordered":true,"$db":"bezkoder_db","lsid":{"id":{"$binary":{"base64":"Y1gwgzagTrWYMjc5pKAw0A==","subType":"04"}}}} }	{"clientConnId": 7}
2023-07-14T10:50:59.397Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 7, "expected": {"$db":"bezkoder_db","insert":"tutorials","lsid":{"id":{"Subtype":4,"Data":"l9rYpESIQkSsaf7uo8Dg7w=="}},"ordered":true}, "actual": {"$db":"bezkoder_db","insert":"tutorials","lsid":{"id":{"Subtype":4,"Data":"Y1gwgzagTrWYMjc5pKAw0A=="}},"ordered":true}}
2023-07-14T10:50:59.397Z	DEBUG	mongoparser/mongoparser.go:1073	the diff is: [map[lsid].map[id]: {4 [151 218 216 164 68 136 66 68 172 105 254 238 163 192 224 239]} != {4 [99 88 48 131 54 160 78 181 152 50 55 57 164 160 48 208]}], len(diff): 1. bool: true	{"clientConnId": 7}
2023-07-14T10:50:59.397Z	DEBUG	mongoparser/mongoparser.go:642	the sections are not matched. 	{"clientConnId": 7, "expected": "{ SectionSingle msg: {\"insert\":\"tutorials\",\"ordered\":true,\"$db\":\"bezkoder_db\",\"lsid\":{\"id\":{\"$binary\":{\"base64\":\"l9rYpESIQkSsaf7uo8Dg7w==\",\"subType\":\"04\"}}}} }", "actual": "{ SectionSingle msg: {\"insert\":\"tutorials\",\"ordered\":true,\"$db\":\"bezkoder_db\",\"lsid\":{\"id\":{\"$binary\":{\"base64\":\"Y1gwgzagTrWYMjc5pKAw0A==\",\"subType\":\"04\"}}}} }"}
an iteration of a mongo request lifecycle is completed. clientconnid: 7
read bytes:  52 , err:  <nil>
  the clientConnId:  19
2023-07-14T10:50:59.756Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 19 and the time delay: 10.039969732s	{"clientConnId": 19}
2023-07-14T10:50:59.756Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {52 6 0 OP_MSG}	{"clientConnId": 19}
2023-07-14T10:50:59.756Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }	{"clientConnId": 19}
the request buffer:  4          ›          hello    $db    admin    clientConnId:  19
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{52 6 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{52 6 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
2023-07-14T10:50:59.756Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }	{"clientConnId": 19}
2023-07-14T10:50:59.756Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 19, "expected": {"$db":"admin","hello":1}, "actual": {"$db":"admin","hello":1}}
the recieved request:   header: &{52 6 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
an iteration of a mongo request lifecycle is completed. clientconnid: 19
read bytes:  0 , err:  EOF
  the clientConnId:  19
2023-07-14T10:51:09.766Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 19 and the time delay: 20.049811376s	{"clientConnId": 19}
2023-07-14T10:51:09.766Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 19}
2023-07-14T10:51:09.766Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 19, "error": "malformed wire message: insufficient bytes", "clientConnId": 19}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:51:09.766Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20071}
read bytes:  0 , err:  EOF
  the clientConnId:  34
2023-07-14T10:51:09.805Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 34 and the time delay: 20.092202425s	{"clientConnId": 34}
2023-07-14T10:51:09.805Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 34}
2023-07-14T10:51:09.805Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 34, "error": "malformed wire message: insufficient bytes", "clientConnId": 34}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:51:09.806Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20111}
2023-07-14T10:51:09.806Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:51:09.817Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:51:09.817Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:51:09.817Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 43272, "Time": 1689331869}
2023-07-14T10:51:09.817Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:51:09.817Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 43272}
read bytes:  317 , err:  <nil>
2023-07-14T10:51:09.818Z	DEBUG	proxy/proxy.go:615	the clientConnId: 57
into processing mongo. clientConnId:  57
into test mode. clientConnId:  57
into decode mongo. clientConnId:  57
2023-07-14T10:51:09.818Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 57 and the time delay: 920ns	{"clientConnId": 57}
2023-07-14T10:51:09.818Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 7 0 OP_QUERY}	{"clientConnId": 57}
2023-07-14T10:51:09.818Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 57}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  57
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  57
the recieved request:   header: &{317 7 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  57
2023-07-14T10:51:09.819Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 57}
2023-07-14T10:51:09.819Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331869	{"clientConnId": 57}
2023-07-14T10:51:09.819Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331869"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 57}
2023-07-14T10:51:09.819Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime ù(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 57, "clientconnid": 57}
an iteration of a mongo request lifecycle is completed. clientconnid: 57
2023-07-14T10:51:09.823Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=5282056}
read bytes:  197 , err:  <nil>
  the clientConnId:  57
2023-07-14T10:51:09.824Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 57 and the time delay: 6.122289ms	{"clientConnId": 57}
2023-07-14T10:51:09.824Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 8 0 OP_MSG}	{"clientConnId": 57}
2023-07-14T10:51:09.825Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 57}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  57
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  57
the recieved request:   header: &{197 8 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 8 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 8 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:51:09.825Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 57}
2023-07-14T10:51:09.825Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 57, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 57
2023-07-14T10:51:19.768Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:51:19.768Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:51:19.768Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 49434, "Time": 1689331879}
2023-07-14T10:51:19.768Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:51:19.768Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 49434}
read bytes:  317 , err:  <nil>
2023-07-14T10:51:19.768Z	DEBUG	proxy/proxy.go:615	the clientConnId: 91
into processing mongo. clientConnId:  91
into test mode. clientConnId:  91
into decode mongo. clientConnId:  91
2023-07-14T10:51:19.768Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 91 and the time delay: 920ns	{"clientConnId": 91}
2023-07-14T10:51:19.768Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 9 0 OP_QUERY}	{"clientConnId": 91}
2023-07-14T10:51:19.768Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 91}
the request buffer:  =  	       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  91
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  91
the recieved request:   header: &{317 9 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  91
2023-07-14T10:51:19.769Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 91}
2023-07-14T10:51:19.769Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331879	{"clientConnId": 91}
2023-07-14T10:51:19.769Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331879"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 91}
2023-07-14T10:51:19.769Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I     	                        %  connectionId    helloOk ismaster 	localTime ß(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 91, "clientconnid": 91}
an iteration of a mongo request lifecycle is completed. clientconnid: 91
read bytes:  52 , err:  <nil>
  the clientConnId:  91
2023-07-14T10:51:29.772Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 91 and the time delay: 10.003449932s	{"clientConnId": 91}
2023-07-14T10:51:29.772Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {52 10 0 OP_MSG}	{"clientConnId": 91}
2023-07-14T10:51:29.772Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }	{"clientConnId": 91}
the request buffer:  4   
       ›          hello    $db    admin    clientConnId:  91
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  91
the recieved request:   header: &{52 10 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{52 10 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
2023-07-14T10:51:29.772Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }	{"clientConnId": 91}
2023-07-14T10:51:29.772Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 91, "expected": {"$db":"admin","hello":1}, "actual": {"$db":"admin","hello":1}}
the recieved request:   header: &{52 10 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
an iteration of a mongo request lifecycle is completed. clientconnid: 91
read bytes:  0 , err:  EOF
  the clientConnId:  57
2023-07-14T10:51:29.836Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 57 and the time delay: 20.017958513s	{"clientConnId": 57}
2023-07-14T10:51:29.836Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 57}
2023-07-14T10:51:29.836Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 57, "error": "malformed wire message: insufficient bytes", "clientConnId": 57}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:51:29.836Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20019}
2023-07-14T10:51:29.836Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:51:29.840Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:51:29.840Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:51:29.840Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 39994, "Time": 1689331889}
2023-07-14T10:51:29.840Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:51:29.840Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 39994}
read bytes:  317 , err:  <nil>
2023-07-14T10:51:29.844Z	DEBUG	proxy/proxy.go:615	the clientConnId: 41
into processing mongo. clientConnId:  41
into test mode. clientConnId:  41
into decode mongo. clientConnId:  41
2023-07-14T10:51:29.844Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 41 and the time delay: 1.04¬µs	{"clientConnId": 41}
2023-07-14T10:51:29.844Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 11 0 OP_QUERY}	{"clientConnId": 41}
2023-07-14T10:51:29.844Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 41}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  41
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{317 11 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  41
2023-07-14T10:51:29.845Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 41}
2023-07-14T10:51:29.845Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331889	{"clientConnId": 41}
2023-07-14T10:51:29.845Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331889"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 41}
2023-07-14T10:51:29.845Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime ±(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 41, "clientconnid": 41}
an iteration of a mongo request lifecycle is completed. clientconnid: 41
2023-07-14T10:51:29.846Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=6421535}
read bytes:  197 , err:  <nil>
  the clientConnId:  41
2023-07-14T10:51:29.849Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 41 and the time delay: 4.252139ms	{"clientConnId": 41}
2023-07-14T10:51:29.849Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 12 0 OP_MSG}	{"clientConnId": 41}
2023-07-14T10:51:29.849Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 41}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  41
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{197 12 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 12 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 12 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:51:29.849Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 41}
2023-07-14T10:51:29.849Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 41, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 41
read bytes:  0 , err:  EOF
  the clientConnId:  91
2023-07-14T10:51:39.781Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 91 and the time delay: 20.012930884s	{"clientConnId": 91}
2023-07-14T10:51:39.781Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 91}
2023-07-14T10:51:39.781Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 91, "error": "malformed wire message: insufficient bytes", "clientConnId": 91}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:51:39.781Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20013}
2023-07-14T10:51:49.782Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:51:49.782Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:51:49.782Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42128, "Time": 1689331909}
2023-07-14T10:51:49.783Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:51:49.783Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42128}
read bytes:  317 , err:  <nil>
2023-07-14T10:51:49.783Z	DEBUG	proxy/proxy.go:615	the clientConnId: 89
into processing mongo. clientConnId:  89
into test mode. clientConnId:  89
into decode mongo. clientConnId:  89
2023-07-14T10:51:49.783Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 89 and the time delay: 970ns	{"clientConnId": 89}
2023-07-14T10:51:49.783Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 13 0 OP_QUERY}	{"clientConnId": 89}
2023-07-14T10:51:49.783Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 89}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  89
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  89
the recieved request:   header: &{317 13 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  89
2023-07-14T10:51:49.783Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 89}
2023-07-14T10:51:49.783Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331909	{"clientConnId": 89}
2023-07-14T10:51:49.783Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331909"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 89}
2023-07-14T10:51:49.784Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime ≈(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 89, "clientconnid": 89}
an iteration of a mongo request lifecycle is completed. clientconnid: 89
read bytes:  0 , err:  EOF
  the clientConnId:  41
2023-07-14T10:51:49.857Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 41 and the time delay: 20.012286123s	{"clientConnId": 41}
2023-07-14T10:51:49.857Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 41}
2023-07-14T10:51:49.857Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 41, "error": "malformed wire message: insufficient bytes", "clientConnId": 41}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:51:49.857Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20016}
2023-07-14T10:51:49.857Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:51:49.860Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:51:49.860Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:51:49.860Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42130, "Time": 1689331909}
2023-07-14T10:51:49.860Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:51:49.860Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42130}
read bytes:  317 , err:  <nil>
2023-07-14T10:51:49.860Z	DEBUG	proxy/proxy.go:615	the clientConnId: 1
into processing mongo. clientConnId:  1
into test mode. clientConnId:  1
into decode mongo. clientConnId:  1
2023-07-14T10:51:49.860Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 1 and the time delay: 900ns	{"clientConnId": 1}
2023-07-14T10:51:49.860Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 14 0 OP_QUERY}	{"clientConnId": 1}
2023-07-14T10:51:49.860Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 1}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  1
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  1
the recieved request:   header: &{317 14 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  1
2023-07-14T10:51:49.860Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 1}
2023-07-14T10:51:49.860Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331909	{"clientConnId": 1}
2023-07-14T10:51:49.861Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331909"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 1}
2023-07-14T10:51:49.861Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime ≈(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 1, "clientconnid": 1}
an iteration of a mongo request lifecycle is completed. clientconnid: 1
2023-07-14T10:51:49.862Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2811675}
read bytes:  197 , err:  <nil>
  the clientConnId:  1
2023-07-14T10:51:49.863Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 1 and the time delay: 2.898577ms	{"clientConnId": 1}
2023-07-14T10:51:49.863Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 15 0 OP_MSG}	{"clientConnId": 1}
2023-07-14T10:51:49.863Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 1}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  1
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  1
the recieved request:   header: &{197 15 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 15 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 15 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:51:49.863Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 1}
2023-07-14T10:51:49.863Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 1, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 1
read bytes:  52 , err:  <nil>
  the clientConnId:  89
2023-07-14T10:51:59.786Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 89 and the time delay: 10.002845191s	{"clientConnId": 89}
2023-07-14T10:51:59.786Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {52 16 0 OP_MSG}	{"clientConnId": 89}
2023-07-14T10:51:59.786Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }	{"clientConnId": 89}
the request buffer:  4          ›          hello    $db    admin    clientConnId:  89
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  89
the recieved request:   header: &{52 16 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{52 16 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
2023-07-14T10:51:59.786Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }	{"clientConnId": 89}
2023-07-14T10:51:59.786Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 89, "expected": {"$db":"admin","hello":1}, "actual": {"$db":"admin","hello":1}}
the recieved request:   header: &{52 16 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
an iteration of a mongo request lifecycle is completed. clientconnid: 89
read bytes:  0 , err:  EOF
  the clientConnId:  89
2023-07-14T10:52:09.790Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 89 and the time delay: 20.007199747s	{"clientConnId": 89}
2023-07-14T10:52:09.790Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 89}
2023-07-14T10:52:09.790Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 89, "error": "malformed wire message: insufficient bytes", "clientConnId": 89}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:52:09.790Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20007}
read bytes:  0 , err:  EOF
  the clientConnId:  1
2023-07-14T10:52:09.884Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 1 and the time delay: 20.023858649s	{"clientConnId": 1}
2023-07-14T10:52:09.884Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 1}
2023-07-14T10:52:09.884Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 1, "error": "malformed wire message: insufficient bytes", "clientConnId": 1}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:52:09.884Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-14T10:52:09.884Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:52:09.889Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:52:09.889Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:52:09.889Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 36694, "Time": 1689331929}
2023-07-14T10:52:09.889Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:52:09.889Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 36694}
read bytes:  317 , err:  <nil>
2023-07-14T10:52:09.889Z	DEBUG	proxy/proxy.go:615	the clientConnId: 86
into processing mongo. clientConnId:  86
into test mode. clientConnId:  86
into decode mongo. clientConnId:  86
2023-07-14T10:52:09.889Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 86 and the time delay: 1.17¬µs	{"clientConnId": 86}
2023-07-14T10:52:09.889Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 17 0 OP_QUERY}	{"clientConnId": 86}
2023-07-14T10:52:09.890Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 86}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  86
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  86
the recieved request:   header: &{317 17 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  86
2023-07-14T10:52:09.890Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 86}
2023-07-14T10:52:09.890Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331929	{"clientConnId": 86}
2023-07-14T10:52:09.890Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331929"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 86}
2023-07-14T10:52:09.891Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I  	                           %  connectionId    helloOk ismaster 	localTime Ÿ(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 86, "clientconnid": 86}
an iteration of a mongo request lifecycle is completed. clientconnid: 86
2023-07-14T10:52:09.895Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=7295219}
read bytes:  197 , err:  <nil>
  the clientConnId:  86
2023-07-14T10:52:09.898Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 86 and the time delay: 9.098617ms	{"clientConnId": 86}
2023-07-14T10:52:09.899Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 18 0 OP_MSG}	{"clientConnId": 86}
2023-07-14T10:52:09.899Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 86}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  86
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  86
the recieved request:   header: &{197 18 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 18 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 18 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:52:09.899Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 86}
2023-07-14T10:52:09.899Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 86, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 86
2023-07-14T10:52:19.791Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:52:19.791Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:52:19.791Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 45836, "Time": 1689331939}
2023-07-14T10:52:19.791Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:52:19.792Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 45836}
read bytes:  317 , err:  <nil>
2023-07-14T10:52:19.792Z	DEBUG	proxy/proxy.go:615	the clientConnId: 32
into processing mongo. clientConnId:  32
into test mode. clientConnId:  32
into decode mongo. clientConnId:  32
2023-07-14T10:52:19.792Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 32 and the time delay: 830ns	{"clientConnId": 32}
2023-07-14T10:52:19.792Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 19 0 OP_QUERY}	{"clientConnId": 32}
2023-07-14T10:52:19.792Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 32}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  32
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  32
the recieved request:   header: &{317 19 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  32
2023-07-14T10:52:19.792Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 32}
2023-07-14T10:52:19.792Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331939	{"clientConnId": 32}
2023-07-14T10:52:19.792Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331939"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 32}
2023-07-14T10:52:19.792Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I  
                           %  connectionId    helloOk ismaster 	localTime „(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 32, "clientconnid": 32}
an iteration of a mongo request lifecycle is completed. clientconnid: 32
read bytes:  52 , err:  <nil>
  the clientConnId:  32
2023-07-14T10:52:29.794Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 32 and the time delay: 10.00211237s	{"clientConnId": 32}
2023-07-14T10:52:29.794Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {52 20 0 OP_MSG}	{"clientConnId": 32}
2023-07-14T10:52:29.794Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }	{"clientConnId": 32}
the request buffer:  4          ›          hello    $db    admin    clientConnId:  32
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  32
the recieved request:   header: &{52 20 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{52 20 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
2023-07-14T10:52:29.794Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }	{"clientConnId": 32}
2023-07-14T10:52:29.794Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 32, "expected": {"$db":"admin","hello":1}, "actual": {"$db":"admin","hello":1}}
the recieved request:   header: &{52 20 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
an iteration of a mongo request lifecycle is completed. clientconnid: 32
read bytes:  0 , err:  EOF
  the clientConnId:  86
2023-07-14T10:52:29.921Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 86 and the time delay: 20.0314344s	{"clientConnId": 86}
2023-07-14T10:52:29.921Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 86}
2023-07-14T10:52:29.921Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 86, "error": "malformed wire message: insufficient bytes", "clientConnId": 86}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:52:29.921Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20032}
2023-07-14T10:52:29.920Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:52:29.923Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:52:29.923Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:52:29.923Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 45648, "Time": 1689331949}
2023-07-14T10:52:29.923Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:52:29.923Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 45648}
read bytes:  317 , err:  <nil>
2023-07-14T10:52:29.924Z	DEBUG	proxy/proxy.go:615	the clientConnId: 15
into processing mongo. clientConnId:  15
into test mode. clientConnId:  15
into decode mongo. clientConnId:  15
2023-07-14T10:52:29.925Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 15 and the time delay: 1.18¬µs	{"clientConnId": 15}
2023-07-14T10:52:29.925Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 21 0 OP_QUERY}	{"clientConnId": 15}
2023-07-14T10:52:29.925Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 15}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  15
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  15
the recieved request:   header: &{317 21 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  15
2023-07-14T10:52:29.925Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 15}
2023-07-14T10:52:29.925Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331949	{"clientConnId": 15}
2023-07-14T10:52:29.925Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331949"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 15}
2023-07-14T10:52:29.925Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime Ì(±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 15, "clientconnid": 15}
an iteration of a mongo request lifecycle is completed. clientconnid: 15
2023-07-14T10:52:29.927Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=3830632}
read bytes:  197 , err:  <nil>
  the clientConnId:  15
2023-07-14T10:52:29.929Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 15 and the time delay: 3.969034ms	{"clientConnId": 15}
2023-07-14T10:52:29.929Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 22 0 OP_MSG}	{"clientConnId": 15}
2023-07-14T10:52:29.929Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 15}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  15
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  15
the recieved request:   header: &{197 22 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 22 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 22 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:52:29.929Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 15}
2023-07-14T10:52:29.929Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 15, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 15
read bytes:  0 , err:  EOF
  the clientConnId:  32
2023-07-14T10:52:39.802Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 32 and the time delay: 20.010071098s	{"clientConnId": 32}
2023-07-14T10:52:39.802Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 32}
2023-07-14T10:52:39.802Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 32, "error": "malformed wire message: insufficient bytes", "clientConnId": 32}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:52:39.802Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20010}
2023-07-14T10:52:49.803Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:52:49.803Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:52:49.803Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 56514, "Time": 1689331969}
2023-07-14T10:52:49.803Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:52:49.803Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 56514}
read bytes:  317 , err:  <nil>
2023-07-14T10:52:49.804Z	DEBUG	proxy/proxy.go:615	the clientConnId: 85
into processing mongo. clientConnId:  85
into test mode. clientConnId:  85
into decode mongo. clientConnId:  85
2023-07-14T10:52:49.804Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 85 and the time delay: 990ns	{"clientConnId": 85}
2023-07-14T10:52:49.804Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 23 0 OP_QUERY}	{"clientConnId": 85}
2023-07-14T10:52:49.804Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 85}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  85
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  85
the recieved request:   header: &{317 23 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  85
2023-07-14T10:52:49.804Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 85}
2023-07-14T10:52:49.804Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331969	{"clientConnId": 85}
2023-07-14T10:52:49.804Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331969"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 85}
2023-07-14T10:52:49.804Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime )±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 85, "clientconnid": 85}
an iteration of a mongo request lifecycle is completed. clientconnid: 85
read bytes:  0 , err:  EOF
  the clientConnId:  15
2023-07-14T10:52:49.932Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 15 and the time delay: 20.007352203s	{"clientConnId": 15}
2023-07-14T10:52:49.932Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 15}
2023-07-14T10:52:49.932Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 15, "error": "malformed wire message: insufficient bytes", "clientConnId": 15}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:52:49.932Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20009}
2023-07-14T10:52:49.932Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:52:49.935Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:52:49.935Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:52:49.935Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 56520, "Time": 1689331969}
2023-07-14T10:52:49.935Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:52:49.935Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 56520}
read bytes:  317 , err:  <nil>
2023-07-14T10:52:49.935Z	DEBUG	proxy/proxy.go:615	the clientConnId: 5
into processing mongo. clientConnId:  5
into test mode. clientConnId:  5
into decode mongo. clientConnId:  5
2023-07-14T10:52:49.935Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 5 and the time delay: 1.02¬µs	{"clientConnId": 5}
2023-07-14T10:52:49.935Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 24 0 OP_QUERY}	{"clientConnId": 5}
2023-07-14T10:52:49.935Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 5}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  5
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  5
the recieved request:   header: &{317 24 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  5
2023-07-14T10:52:49.936Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 5}
2023-07-14T10:52:49.936Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331969	{"clientConnId": 5}
2023-07-14T10:52:49.936Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331969"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 5}
2023-07-14T10:52:49.936Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime )±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 5, "clientconnid": 5}
an iteration of a mongo request lifecycle is completed. clientconnid: 5
2023-07-14T10:52:49.937Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=3037799}
read bytes:  197 , err:  <nil>
  the clientConnId:  5
2023-07-14T10:52:49.939Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 5 and the time delay: 3.712841ms	{"clientConnId": 5}
2023-07-14T10:52:49.939Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 25 0 OP_MSG}	{"clientConnId": 5}
2023-07-14T10:52:49.939Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 5}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  5
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  5
the recieved request:   header: &{197 25 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 25 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 25 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:52:49.939Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 5}
2023-07-14T10:52:49.940Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 5, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 5
read bytes:  52 , err:  <nil>
  the clientConnId:  85
2023-07-14T10:52:59.806Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 85 and the time delay: 10.002239002s	{"clientConnId": 85}
2023-07-14T10:52:59.806Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {52 26 0 OP_MSG}	{"clientConnId": 85}
2023-07-14T10:52:59.806Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }	{"clientConnId": 85}
the request buffer:  4          ›          hello    $db    admin    clientConnId:  85
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  85
the recieved request:   header: &{52 26 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{52 26 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
2023-07-14T10:52:59.806Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }	{"clientConnId": 85}
2023-07-14T10:52:59.806Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 85, "expected": {"$db":"admin","hello":1}, "actual": {"$db":"admin","hello":1}}
the recieved request:   header: &{52 26 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
an iteration of a mongo request lifecycle is completed. clientconnid: 85
read bytes:  0 , err:  EOF
  the clientConnId:  85
2023-07-14T10:53:09.815Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 85 and the time delay: 20.011579938s	{"clientConnId": 85}
2023-07-14T10:53:09.815Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 85}
2023-07-14T10:53:09.815Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 85, "error": "malformed wire message: insufficient bytes", "clientConnId": 85}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:53:09.816Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20012}
read bytes:  0 , err:  EOF
  the clientConnId:  5
2023-07-14T10:53:09.956Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 5 and the time delay: 20.020571073s	{"clientConnId": 5}
2023-07-14T10:53:09.956Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 5}
2023-07-14T10:53:09.956Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 5, "error": "malformed wire message: insufficient bytes", "clientConnId": 5}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:53:09.956Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20021}
2023-07-14T10:53:09.956Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:53:09.960Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:53:09.960Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:53:09.960Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 41380, "Time": 1689331989}
2023-07-14T10:53:09.960Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:53:09.960Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 41380}
read bytes:  317 , err:  <nil>
2023-07-14T10:53:09.960Z	DEBUG	proxy/proxy.go:615	the clientConnId: 58
into processing mongo. clientConnId:  58
into test mode. clientConnId:  58
into decode mongo. clientConnId:  58
2023-07-14T10:53:09.960Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 58 and the time delay: 960ns	{"clientConnId": 58}
2023-07-14T10:53:09.960Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 27 0 OP_QUERY}	{"clientConnId": 58}
2023-07-14T10:53:09.960Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 58}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  58
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  58
the recieved request:   header: &{317 27 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  58
2023-07-14T10:53:09.960Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 58}
2023-07-14T10:53:09.960Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331989	{"clientConnId": 58}
2023-07-14T10:53:09.961Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331989"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 58}
2023-07-14T10:53:09.961Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime )±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 58, "clientconnid": 58}
an iteration of a mongo request lifecycle is completed. clientconnid: 58
2023-07-14T10:53:09.964Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=6516816}
read bytes:  197 , err:  <nil>
  the clientConnId:  58
2023-07-14T10:53:09.965Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 58 and the time delay: 5.363757ms	{"clientConnId": 58}
2023-07-14T10:53:09.966Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 28 0 OP_MSG}	{"clientConnId": 58}
2023-07-14T10:53:09.966Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 58}
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  58
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  58
the recieved request:   header: &{197 28 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 28 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 28 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:53:09.966Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 58}
2023-07-14T10:53:09.966Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 58, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 58
2023-07-14T10:53:19.817Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:53:19.817Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:53:19.817Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42876, "Time": 1689331999}
2023-07-14T10:53:19.817Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:53:19.817Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42876}
read bytes:  317 , err:  <nil>
2023-07-14T10:53:19.817Z	DEBUG	proxy/proxy.go:615	the clientConnId: 49
into processing mongo. clientConnId:  49
into test mode. clientConnId:  49
into decode mongo. clientConnId:  49
2023-07-14T10:53:19.817Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 49 and the time delay: 670ns	{"clientConnId": 49}
2023-07-14T10:53:19.817Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 29 0 OP_QUERY}	{"clientConnId": 49}
2023-07-14T10:53:19.817Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 49}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  49
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  49
the recieved request:   header: &{317 29 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  49
2023-07-14T10:53:19.817Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 49}
2023-07-14T10:53:19.817Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689331999	{"clientConnId": 49}
2023-07-14T10:53:19.818Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689331999"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 49}
2023-07-14T10:53:19.818Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime )±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 49, "clientconnid": 49}
an iteration of a mongo request lifecycle is completed. clientconnid: 49
read bytes:  52 , err:  <nil>
  the clientConnId:  49
2023-07-14T10:53:29.821Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 49 and the time delay: 10.003913911s	{"clientConnId": 49}
2023-07-14T10:53:29.821Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {52 30 0 OP_MSG}	{"clientConnId": 49}
2023-07-14T10:53:29.821Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }	{"clientConnId": 49}
the request buffer:  4          ›          hello    $db    admin    clientConnId:  49
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  49
the recieved request:   header: &{52 30 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{52 30 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
2023-07-14T10:53:29.821Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }	{"clientConnId": 49}
2023-07-14T10:53:29.822Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 49, "expected": {"$db":"admin","hello":1}, "actual": {"$db":"admin","hello":1}}
the recieved request:   header: &{52 30 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
an iteration of a mongo request lifecycle is completed. clientconnid: 49
read bytes:  0 , err:  EOF
  the clientConnId:  58
2023-07-14T10:53:29.986Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 58 and the time delay: 20.025568708s	{"clientConnId": 58}
2023-07-14T10:53:29.986Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 58}
2023-07-14T10:53:29.986Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 58, "error": "malformed wire message: insufficient bytes", "clientConnId": 58}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:53:29.986Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20026}
2023-07-14T10:53:29.986Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-14T10:53:29.988Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:53:29.988Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:53:29.988Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 37100, "Time": 1689332009}
2023-07-14T10:53:29.988Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2130706433], "DestPort": 27017, "KernelPid": 126528}
2023-07-14T10:53:29.988Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 37100}
read bytes:  317 , err:  <nil>
2023-07-14T10:53:29.988Z	DEBUG	proxy/proxy.go:615	the clientConnId: 23
into processing mongo. clientConnId:  23
into test mode. clientConnId:  23
into decode mongo. clientConnId:  23
2023-07-14T10:53:29.988Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 23 and the time delay: 930ns	{"clientConnId": 23}
2023-07-14T10:53:29.988Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {317 31 0 OP_QUERY}	{"clientConnId": 23}
2023-07-14T10:53:29.989Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }	{"clientConnId": 23}
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  23
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  23
the recieved request:   header: &{317 31 0 OP_QUERY}  
the expected request:   header: &{317 1 0 OP_QUERY}
the request query matches. clientconnid:  23
2023-07-14T10:53:29.989Z	DEBUG	mongoparser/operation.go:793	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689322971024"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"1"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}	{"clientConnId": 23}
2023-07-14T10:53:29.989Z	DEBUG	mongoparser/operation.go:807	the updated document string is: 1689332009	{"clientConnId": 23}
2023-07-14T10:53:29.989Z	DEBUG	mongoparser/operation.go:830	the elements of the reply docs: ["connectionId": {"$numberInt":"1"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689332009"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64b105ba33c7a25846cd9e7c"}}]	{"clientConnId": 23}
2023-07-14T10:53:29.989Z	DEBUG	mongoparser/mongoparser.go:495	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime ))±d    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId d±∫3«¢XFÕû|  	{"clientConnId": 23, "clientconnid": 23}
an iteration of a mongo request lifecycle is completed. clientconnid: 23
2023-07-14T10:53:29.990Z  INFO 126528 --- [localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2325467}
read bytes:  197 , err:  <nil>
  the clientConnId:  23
2023-07-14T10:53:29.992Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 23 and the time delay: 3.098631ms	{"clientConnId": 23}
2023-07-14T10:53:29.992Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {197 32 0 OP_MSG}	{"clientConnId": 23}
2023-07-14T10:53:29.992Z	DEBUG	mongoparser/operation.go:167	the decoded string for the wiremessage: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }	{"clientConnId": 23}
the request buffer:  ≈           ›      ∞   hello    helloOk topologyVersion -   processId d±∫3«¢XFÕû|counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  23
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  23
the recieved request:   header: &{197 32 0 OP_MSG}  
the expected request:   header: &{317 1 0 OP_QUERY}
the recieved request:   header: &{197 32 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 32 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
2023-07-14T10:53:29.992Z	DEBUG	mongoparser/mongoparser.go:997	the sections are. Expected: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }
 and actual: { SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64b105ba33c7a25846cd9e7c"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }	{"clientConnId": 23}
2023-07-14T10:53:29.992Z	DEBUG	mongoparser/mongoparser.go:1071	the expected and actual msg in the single section.	{"clientConnId": 23, "expected": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}, "actual": {"$db":"admin","$readPreference":{"mode":"primaryPreferred"},"hello":1,"helloOk":true,"maxAwaitTimeMS":10000,"topologyVersion":{"counter":0,"processId":"64b105ba33c7a25846cd9e7c"}}}
an iteration of a mongo request lifecycle is completed. clientconnid: 23
read bytes:  0 , err:  EOF
  the clientConnId:  49
2023-07-14T10:53:39.831Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 49 and the time delay: 20.013470132s	{"clientConnId": 49}
2023-07-14T10:53:39.831Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 49}
2023-07-14T10:53:39.831Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 49, "error": "malformed wire message: insufficient bytes", "clientConnId": 49}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:53:39.831Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20013}
2023-07-14T10:53:41.451Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 125703}
2023-07-14T10:53:41.451Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-14T10:53:41.451Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 58862, "Time": 1689332021}
2023-07-14T10:53:41.451Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,0,1], "DestPort": 8080, "KernelPid": 126528}
2023-07-14T10:53:41.451Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 58862}
read bytes:  0 , err:  read tcp [::1]:16789->[::1]:58862: read: connection reset by peer
2023-07-14T10:53:41.451Z	DEBUG	proxy/proxy.go:615	the clientConnId: 14
2023-07-14T10:53:41.451Z	ERROR	proxy/proxy.go:618	üê∞ Keploy:failed to read the request message in proxy	{"error": "read tcp [::1]:16789->[::1]:58862: read: connection reset by peer", "proxy port": 16789}
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:618
2023-07-14T10:53:44.583Z	DEBUG	connection/tracker.go:119	üê∞ Keploy:Got a close event from eBPF	{"TotalReadBytes": 304, "TotalWrittenBytes": 0}
read bytes:  0 , err:  EOF
  the clientConnId:  23
2023-07-14T10:53:49.582Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 23 and the time delay: 19.593202202s	{"clientConnId": 23}
2023-07-14T10:53:49.582Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 23}
2023-07-14T10:53:49.582Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 23, "error": "malformed wire message: insufficient bytes", "clientConnId": 23}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:53:49.582Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 19593}
read bytes:  0 , err:  EOF
  the clientConnId:  7
2023-07-14T10:53:49.927Z	DEBUG	mongoparser/mongoparser.go:345	the lopp starts for clientConnId: 7 and the time delay: 2m50.559764234s	{"clientConnId": 7}
2023-07-14T10:53:49.927Z	DEBUG	mongoparser/operation.go:59	the mongo msg header: {0 0 0 <invalid opcode>}	{"clientConnId": 7}
2023-07-14T10:53:49.927Z	ERROR	mongoparser/mongoparser.go:348	üê∞ Keploy:failed to decode the mongo wire message from the client	{"clientConnId": 7, "error": "malformed wire message: insufficient bytes", "clientConnId": 7}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:348
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:47
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:718
2023-07-14T10:53:49.927Z	DEBUG	proxy/proxy.go:743	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 170562}
2023-07-14T10:56:25.076Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:25.077Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-14T10:56:25.077Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:56:25.077Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:25.078Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-14T10:56:25.078Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:56:25.078Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:25.078Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-14T10:56:25.078Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:56:26.078Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup ip-172-31-22-141.ap-south-1.compute.internal: i/o timeout"}
2023-07-14T10:56:26.078Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-14T10:56:26.079Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:26.079Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup ip-172-31-22-141.ap-south-1.compute.internal: i/o timeout"}
2023-07-14T10:56:26.079Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-14T10:56:26.079Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup ip-172-31-22-141.ap-south-1.compute.internal: i/o timeout"}
2023-07-14T10:56:26.079Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:26.079Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-14T10:56:26.079Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:40.027Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:40.027Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-14T10:56:40.027Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:56:40.027Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:40.028Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:40.028Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-14T10:56:40.028Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:56:40.028Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:56:47.169Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:47.218Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:47.219Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 12}
2023-07-14T10:56:47.219Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "141.22.31.172.in-addr.arpa."}
2023-07-14T10:56:47.219Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:56:47.219Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-14T10:56:47.220Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "141.22.31.172.in-addr.arpa."}
2023-07-14T10:56:48.220Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup 141.22.31.172.in-addr.arpa: i/o timeout"}
2023-07-14T10:56:48.220Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-14T10:56:48.220Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:56:48.220Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup 141.22.31.172.in-addr.arpa: i/o timeout"}
2023-07-14T10:56:48.220Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-14T10:56:48.220Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:57:00.652Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:57:00.653Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-14T10:57:00.653Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:57:00.653Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-14T10:57:00.653Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-14T10:57:00.653Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-14T10:57:00.653Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-14T10:57:00.653Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
