2023-07-13T04:23:43.091Z	INFO	hooks/loader.go:595	üê∞ Keploy:keploy initialized and probes added to the kernel.
2023-07-13T04:23:43.091Z	DEBUG	hooks/loader.go:606	üê∞ Keploy:	{"Keploy Inode number": 4026531836}
2023-07-13T04:23:43.091Z	DEBUG	hooks/loader.go:249	üê∞ Keploy:Sending keploy pid to kernel	{"pid": 246469}
2023-07-13T04:23:43.091Z	DEBUG	hooks/loader.go:609	üê∞ Keploy:Keploy Pid sent successfully...
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:185	üê∞ Keploy:Running Dns Server in Test mode...
2023-07-13T04:23:44.226Z	INFO	proxy/proxy.go:186	üê∞ Keploy:Keploy has hijacked the DNS resolution mechanism, your application may misbehave in keploy test mode if you have provided wrong domain name in your application code.
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:194	üê∞ Keploy:Proxy IPv4:Port 2887718541:16789
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:195	üê∞ Keploy:Proxy IPV6:Port Addr [0 0 0 1]:16789
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:313	üê∞ Keploy:	{"ProxyAddress4": "172.31.22.141"}
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:316	üê∞ Keploy:	{"ProxyAddress6": "::1"}
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:363	üê∞ Keploy:	{"ProxyAddress in dns server": "172.31.22.141:16789"}
2023-07-13T04:23:44.226Z	INFO	proxy/proxy.go:380	üê∞ Keploy:starting DNS server at addr:172.31.22.141:16789
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:325	üê∞ Keploy:Proxy server is listening on :[::]:16789
2023-07-13T04:23:44.226Z	DEBUG	proxy/proxy.go:326	üê∞ Keploy:Proxy will accept both ipv4 and ipv6 connections	{"Ipv4": "172.31.22.141", "Ipv6": "::1"}
2023-07-13T04:23:44.226Z	INFO	proxy/proxy.go:196	üê∞ Keploy:Proxy started at port:16789
name for the file test-suite-11
name for the file test-suite-10
name for the file test-suite-9
name for the file testReports
name for the file test-suite-1
name for the file test-suite-12
name for the file test-suite-0
name for the file test-suite-8
2023-07-13T04:23:44.226Z	DEBUG	test/test.go:76	the session indices are : 	{"": ["test-suite-11", "test-suite-10", "test-suite-9", "testReports", "test-suite-1", "test-suite-12", "test-suite-0", "test-suite-8"]}
[ home ubuntu keploy-v2 keploy Keploy test-suite-11 tests]
2023-07-13T04:23:44.227Z	DEBUG	yaml/yaml.go:212	no tests are recorded for the session	{"index": "test-suite-11"}
[ home ubuntu keploy-v2 keploy Keploy test-suite-10 tests]
2023-07-13T04:23:44.227Z	DEBUG	yaml/yaml.go:212	no tests are recorded for the session	{"index": "test-suite-10"}
[ home ubuntu keploy-v2 keploy Keploy test-suite-9 tests]
2023-07-13T04:23:44.227Z	DEBUG	yaml/yaml.go:212	no tests are recorded for the session	{"index": "test-suite-9"}
[ home ubuntu keploy-v2 keploy Keploy testReports tests]
2023-07-13T04:23:44.227Z	DEBUG	yaml/yaml.go:212	no tests are recorded for the session	{"index": "testReports"}
the tests are:  [0xc003fa6600]
the mocks are:  [0xc000c9f180 0xc000c9f220 0xc000c9f2c0] [0xc000ca5c20]
2023-07-13T04:23:51.229Z	DEBUG	hooks/launch.go:101	üê∞ Keploy:Running user application on Linux
2023-07-13T04:23:51.229Z	DEBUG	hooks/launch.go:109	üê∞ Keploy:Waiting for any error from user application

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.1.0)

2023-07-13T04:23:53.188Z  INFO 247283 --- [           main] b.s.d.m.SpringBootDataMongodbApplication : Starting SpringBootDataMongodbApplication v0.0.1-SNAPSHOT using Java 17.0.7 with PID 247283 (/home/ubuntu/java-worksapce/spring-boot-data-mongodb/target/spring-boot-data-mongodb-0.0.1-SNAPSHOT.jar started by root in /home/ubuntu/keploy-v2/keploy)
2023-07-13T04:23:53.200Z  INFO 247283 --- [           main] b.s.d.m.SpringBootDataMongodbApplication : No active profile set, falling back to 1 default profile: "default"
2023-07-13T04:23:54.896Z  INFO 247283 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2023-07-13T04:23:55.042Z  INFO 247283 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 131 ms. Found 1 MongoDB repository interfaces.
2023-07-13T04:23:56.071Z  INFO 247283 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2023-07-13T04:23:56.088Z  INFO 247283 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2023-07-13T04:23:56.089Z  INFO 247283 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.8]
2023-07-13T04:23:56.230Z	DEBUG	hooks/launch.go:111	üê∞ Keploy:After running user application
2023-07-13T04:23:56.230Z	DEBUG	hooks/launch.go:124	üê∞ Keploy:Now setting app pids
2023-07-13T04:23:56.248Z  INFO 247283 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2023-07-13T04:23:56.255Z  INFO 247283 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2878 ms
üê∞ Keploy: Output of pidof [50 52 55 50 56 51 10]
üê∞ Keploy: Output of pidof 247283
Pid of application: 247283
2023-07-13T04:23:56.267Z	DEBUG	hooks/launch.go:134	üê∞ Keploy:PID of application:	{"App pid": 247283}
2023-07-13T04:23:56.267Z	INFO	hooks/launch.go:145	üê∞ Keploy:User application started successfully
2023-07-13T04:23:56.267Z	INFO	test/test.go:155	üê∞ Keploy:	{"no of test cases": 1}
2023-07-13T04:23:56.268Z	DEBUG	test/test.go:170	üê∞ Keploy:Before setting deps.... during testing...
2023-07-13T04:23:56.268Z	DEBUG	test/test.go:172	üê∞ Keploy:Before simulating the request	{"Test case": {"version":"api.keploy.io/v1beta2","kind":"Http","name":"test-1","created":1688979601,"updated":0,"captured":0,"http_req":{"method":"POST","proto_major":1,"proto_minor":1,"url":"http://localhost:8080/url","url_params":null,"header":{"Accept":"*/*","Content-Length":"33","Content-Type":"application/json","User-Agent":"curl/7.74.0"},"body":"{\n  \"url\": \"https://google.com\"\n}","body_type":"","binary":"","form":null},"http_resp":{"status_code":200,"header":{"Content-Length":"65","Content-Type":"application/json; charset=utf-8","Date":"Mon, 10 Jul 2023 09:00:00 GMT"},"body":"{\"ts\":1688979600511813299,\"url\":\"http://localhost:8080/Lhr4BWAi\"}","body_type":"","status_message":"","proto_major":0,"proto_minor":0,"binary":""},"all_keys":null,"anchors":null,"noise":[],"mocks":null,"type":""}}
2023-07-13T04:23:56.698Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:23:56.698Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:23:56.699Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:23:56.699Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:23:56.699Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:23:56.699Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:23:56.699Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:23:56.700Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:23:56.700Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:23:56.744Z  INFO 247283 --- [           main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "4.9.1"}, "os": {"type": "Linux", "name": "Linux", "architecture": "amd64", "version": "5.19.0-1028-aws"}, "platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, streamFactoryFactory=null, commandListeners=[], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, CollectionCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.client.model.mql.ExpressionCodecProvider@5c08c46a, com.mongodb.Jep395RecordCodecProvider@4cf8b2dc]}, loggerSettings=LoggerSettings{maxDocumentLength=1000}, clusterSettings={hosts=[mongodb:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='30000 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, sendBufferSize=0}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, sendBufferSize=0}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, contextProvider=null}
2023-07-13T04:23:57.699Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup mongodb.ap-south-1.compute.internal: i/o timeout"}
2023-07-13T04:23:57.699Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:23:57.699Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:23:57.700Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup mongodb.ap-south-1.compute.internal: i/o timeout"}
2023-07-13T04:23:57.700Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:23:57.700Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:23:57.700Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup mongodb.ap-south-1.compute.internal: i/o timeout"}
2023-07-13T04:23:57.700Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:23:57.700Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:23:57.713Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:23:57.713Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:23:57.713Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42754, "Time": 1689222237}
2023-07-13T04:23:57.713Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:23:57.714Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42754}
2023-07-13T04:23:57.714Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:23:57.714Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:23:57.714Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42766, "Time": 1689222237}
2023-07-13T04:23:57.714Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:23:57.714Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42766}
read bytes:  317 , err:  <nil>
2023-07-13T04:23:57.730Z	DEBUG	proxy/proxy.go:615	the clientConnId: 70
into processing mongo. clientConnId:  70
into test mode. clientConnId:  70
into decode mongo. clientConnId:  70
2023-07-13T04:23:57.730Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 2 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  70
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{317 2 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  70
2023-07-13T04:23:57.730Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:23:57.730Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222237
2023-07-13T04:23:57.731Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222237"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 2 0 OP_QUERY} clientConnId: 70

2023-07-13T04:23:57.731Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime ]|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 70}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:23:57.731Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  317 , err:  <nil>
2023-07-13T04:23:57.736Z	DEBUG	proxy/proxy.go:615	the clientConnId: 10
into processing mongo. clientConnId:  10
into test mode. clientConnId:  10
into decode mongo. clientConnId:  10
2023-07-13T04:23:57.736Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 10 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 1 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  10
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  10
the recieved request:   header: &{317 1 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  10
2023-07-13T04:23:57.736Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:23:57.737Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222237
2023-07-13T04:23:57.737Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222237"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 1 0 OP_QUERY} clientConnId: 10

2023-07-13T04:23:57.737Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime ]|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 10}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:23:57.737Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 10 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:23:57.757Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=36756018}
read bytes:  197 , err:  <nil>
  the clientConnId:  10


 the mongo msg header:  {197 3 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  10
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  10
the recieved request:   header: &{197 3 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 3 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 3 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  10  and destConnId:  0
the responseTo for the OpMsg: 3
2023-07-13T04:23:57.785Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 10
an iteration of a mongo request lifecycle is completed
2023-07-13T04:23:57.785Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 10 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:23:58.171Z  INFO 247283 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2023-07-13T04:23:58.196Z  INFO 247283 --- [           main] b.s.d.m.SpringBootDataMongodbApplication : Started SpringBootDataMongodbApplication in 6.027 seconds (process running for 6.962)
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 4 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 4 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 4 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 4
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:07.757Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 5 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 5 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 5 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 5
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:17.760Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  10


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:24:17.806Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 10}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:24:17.807Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20092}
2023-07-13T04:24:17.806Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:24:17.814Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:24:17.814Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:24:17.815Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 53006, "Time": 1689222257}
2023-07-13T04:24:17.815Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:24:17.815Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 53006}
read bytes:  317 , err:  <nil>
2023-07-13T04:24:17.816Z	DEBUG	proxy/proxy.go:615	the clientConnId: 19
into processing mongo. clientConnId:  19
into test mode. clientConnId:  19
into decode mongo. clientConnId:  19
2023-07-13T04:24:17.816Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 6 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  19
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{317 6 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  19
2023-07-13T04:24:17.816Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:24:17.817Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222257
2023-07-13T04:24:17.817Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222257"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 6 0 OP_QUERY} clientConnId: 19

2023-07-13T04:24:17.817Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime q|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 19}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:17.817Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:24:17.821Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=7014375}
read bytes:  197 , err:  <nil>
  the clientConnId:  19


 the mongo msg header:  {197 7 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  19
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{197 7 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 7 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 7 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  19  and destConnId:  0
the responseTo for the OpMsg: 7
2023-07-13T04:24:17.823Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 19
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:17.823Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 8 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 8 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 8 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 8
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:27.763Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 9 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   	       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 9 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 9 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 9
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:37.765Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  19


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:24:37.826Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 19}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:24:37.826Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20011}
2023-07-13T04:24:37.825Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:24:37.828Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:24:37.829Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:24:37.829Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:24:37.829Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 49582, "Time": 1689222277}
2023-07-13T04:24:37.829Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:24:37.829Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 49582}
read bytes:  317 , err:  <nil>
2023-07-13T04:24:37.830Z	DEBUG	proxy/proxy.go:615	the clientConnId: 64
into processing mongo. clientConnId:  64
into test mode. clientConnId:  64
into decode mongo. clientConnId:  64
2023-07-13T04:24:37.830Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 64 and destConnId: 0. requestBuffer: =  
       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 10 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  
       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  64
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  64
the recieved request:   header: &{317 10 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  64
2023-07-13T04:24:37.830Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:24:37.830Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222277
2023-07-13T04:24:37.830Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222277"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 10 0 OP_QUERY} clientConnId: 64

2023-07-13T04:24:37.830Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      
                        %  connectionId    helloOk ismaster 	localTime Ö|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 64}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:37.830Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 64 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:24:37.831Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2413223}
read bytes:  197 , err:  <nil>
  the clientConnId:  64


 the mongo msg header:  {197 11 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  64
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  64
the recieved request:   header: &{197 11 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 11 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 11 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  64  and destConnId:  0
the responseTo for the OpMsg: 11
2023-07-13T04:24:37.833Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 64
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:37.833Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 64 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 12 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 12 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 12 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 12
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:47.767Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 13 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 13 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 13 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 13
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:57.769Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  64


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:24:57.854Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 64}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:24:57.855Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20026}
2023-07-13T04:24:57.854Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:24:57.858Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:24:57.858Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:24:57.858Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 46592, "Time": 1689222297}
2023-07-13T04:24:57.858Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:24:57.858Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 46592}
read bytes:  317 , err:  <nil>
2023-07-13T04:24:57.858Z	DEBUG	proxy/proxy.go:615	the clientConnId: 68
into processing mongo. clientConnId:  68
into test mode. clientConnId:  68
into decode mongo. clientConnId:  68
2023-07-13T04:24:57.858Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 14 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  68
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  68
the recieved request:   header: &{317 14 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  68
2023-07-13T04:24:57.858Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:24:57.858Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222297
2023-07-13T04:24:57.859Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222297"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 14 0 OP_QUERY} clientConnId: 68

2023-07-13T04:24:57.859Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime ô|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 68}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:57.859Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:24:57.860Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2907489}
read bytes:  197 , err:  <nil>
  the clientConnId:  68


 the mongo msg header:  {197 15 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  68
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  68
the recieved request:   header: &{197 15 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 15 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 15 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  68  and destConnId:  0
the responseTo for the OpMsg: 15
2023-07-13T04:24:57.861Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 68
an iteration of a mongo request lifecycle is completed
2023-07-13T04:24:57.861Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 16 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 16 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 16 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 16
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:07.771Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 17 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 17 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 17 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 17
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:17.772Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  68


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:25:17.883Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 68}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:25:17.884Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20026}
2023-07-13T04:25:17.884Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:25:17.886Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:25:17.887Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:25:17.887Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:25:17.887Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 34664, "Time": 1689222317}
2023-07-13T04:25:17.887Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:25:17.887Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 34664}
read bytes:  317 , err:  <nil>
2023-07-13T04:25:17.888Z	DEBUG	proxy/proxy.go:615	the clientConnId: 50
into processing mongo. clientConnId:  50
into test mode. clientConnId:  50
into decode mongo. clientConnId:  50
2023-07-13T04:25:17.888Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 50 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 18 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  50
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  50
the recieved request:   header: &{317 18 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  50
2023-07-13T04:25:17.888Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:25:17.888Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222317
2023-07-13T04:25:17.889Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222317"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 18 0 OP_QUERY} clientConnId: 50

2023-07-13T04:25:17.889Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime ≠|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 50}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:17.889Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 50 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:25:17.890Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1932886}
read bytes:  197 , err:  <nil>
  the clientConnId:  50


 the mongo msg header:  {197 19 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  50
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  50
the recieved request:   header: &{197 19 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 19 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 19 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  50  and destConnId:  0
the responseTo for the OpMsg: 19
2023-07-13T04:25:17.892Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 50
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:17.892Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 50 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 20 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 20 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 20 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 20
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:27.774Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 21 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 21 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 21 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 21
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:37.776Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  50


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:25:37.912Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 50}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:25:37.912Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-13T04:25:37.911Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:25:37.913Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:25:37.913Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:25:37.913Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 43986, "Time": 1689222337}
2023-07-13T04:25:37.913Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:25:37.913Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 43986}
read bytes:  317 , err:  <nil>
2023-07-13T04:25:37.914Z	DEBUG	proxy/proxy.go:615	the clientConnId: 30
into processing mongo. clientConnId:  30
into test mode. clientConnId:  30
into decode mongo. clientConnId:  30
2023-07-13T04:25:37.914Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 30 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 22 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  30
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  30
the recieved request:   header: &{317 22 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  30
2023-07-13T04:25:37.914Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:25:37.915Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222337
2023-07-13T04:25:37.915Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222337"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 22 0 OP_QUERY} clientConnId: 30

2023-07-13T04:25:37.915Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime ¡|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 30}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:37.915Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 30 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:25:37.917Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=3134732}
read bytes:  197 , err:  <nil>
  the clientConnId:  30


 the mongo msg header:  {197 23 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  30
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  30
the recieved request:   header: &{197 23 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 23 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 23 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  30  and destConnId:  0
the responseTo for the OpMsg: 23
2023-07-13T04:25:37.919Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 30
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:37.919Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 30 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 24 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 24 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 24 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 24
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:47.777Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 25 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 25 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 25 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 25
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:57.779Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  30


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:25:57.939Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 30}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:25:57.939Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20025}
2023-07-13T04:25:57.939Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:25:57.941Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:25:57.942Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:25:57.942Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:25:57.942Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 38322, "Time": 1689222357}
2023-07-13T04:25:57.942Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:25:57.942Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 38322}
read bytes:  317 , err:  <nil>
2023-07-13T04:25:57.942Z	DEBUG	proxy/proxy.go:615	the clientConnId: 82
into processing mongo. clientConnId:  82
into test mode. clientConnId:  82
into decode mongo. clientConnId:  82
2023-07-13T04:25:57.943Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 82 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 26 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  82
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  82
the recieved request:   header: &{317 26 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  82
2023-07-13T04:25:57.943Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:25:57.943Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222357
2023-07-13T04:25:57.943Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222357"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 26 0 OP_QUERY} clientConnId: 82

2023-07-13T04:25:57.943Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime ’|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 82}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:57.943Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 82 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:25:57.945Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2249381}
read bytes:  197 , err:  <nil>
  the clientConnId:  82


 the mongo msg header:  {197 27 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  82
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  82
the recieved request:   header: &{197 27 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 27 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 27 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  82  and destConnId:  0
the responseTo for the OpMsg: 27
2023-07-13T04:25:57.950Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 82
an iteration of a mongo request lifecycle is completed
2023-07-13T04:25:57.950Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 82 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 28 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 28 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 28 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 28
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:07.780Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 29 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 29 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 29 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 29
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:17.782Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  82


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:26:17.969Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 82}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:26:17.969Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20027}
2023-07-13T04:26:17.969Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:26:17.971Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:26:17.971Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:26:17.971Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 49964, "Time": 1689222377}
2023-07-13T04:26:17.972Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:26:17.972Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 49964}
read bytes:  317 , err:  <nil>
2023-07-13T04:26:17.972Z	DEBUG	proxy/proxy.go:615	the clientConnId: 46
into processing mongo. clientConnId:  46
into test mode. clientConnId:  46
into decode mongo. clientConnId:  46
2023-07-13T04:26:17.972Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 46 and destConnId: 0. requestBuffer: =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 30 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =         ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  46
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  46
the recieved request:   header: &{317 30 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  46
2023-07-13T04:26:17.972Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:26:17.972Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222377
2023-07-13T04:26:17.972Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222377"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 30 0 OP_QUERY} clientConnId: 46

2023-07-13T04:26:17.973Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                              %  connectionId    helloOk ismaster 	localTime È|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 46}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:17.973Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 46 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:26:17.974Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2198590}
read bytes:  197 , err:  <nil>
  the clientConnId:  46


 the mongo msg header:  {197 31 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  46
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  46
the recieved request:   header: &{197 31 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 31 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 31 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  46  and destConnId:  0
the responseTo for the OpMsg: 31
2023-07-13T04:26:17.976Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 46
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:17.976Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 46 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 32 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4           ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 32 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 32 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 32
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:27.784Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 33 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   !       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 33 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 33 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 33
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:37.786Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  46


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:26:37.993Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 46}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:26:37.993Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20021}
2023-07-13T04:26:37.993Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:26:37.995Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:26:37.996Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:26:37.996Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:26:37.997Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 39050, "Time": 1689222397}
2023-07-13T04:26:37.997Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:26:37.997Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 39050}
read bytes:  317 , err:  <nil>
2023-07-13T04:26:37.997Z	DEBUG	proxy/proxy.go:615	the clientConnId: 95
into processing mongo. clientConnId:  95
into test mode. clientConnId:  95
into decode mongo. clientConnId:  95
2023-07-13T04:26:37.997Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 95 and destConnId: 0. requestBuffer: =  "       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 34 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  "       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  95
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  95
the recieved request:   header: &{317 34 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  95
2023-07-13T04:26:37.997Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:26:37.997Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222397
2023-07-13T04:26:37.997Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222397"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 34 0 OP_QUERY} clientConnId: 95

2023-07-13T04:26:37.997Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      "                        %  connectionId    helloOk ismaster 	localTime ˝|Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 95}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:37.997Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 95 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:26:37.998Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2299841}
read bytes:  197 , err:  <nil>
  the clientConnId:  95


 the mongo msg header:  {197 35 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   #       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  95
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  95
the recieved request:   header: &{197 35 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 35 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 35 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  95  and destConnId:  0
the responseTo for the OpMsg: 35
2023-07-13T04:26:38.000Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 95
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:38.000Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 95 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 36 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   $       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 36 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 36 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 36
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:47.788Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 37 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   %       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 37 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 37 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 37
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:57.789Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  95


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:26:58.020Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 95}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:26:58.020Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:26:58.020Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:26:58.022Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:26:58.022Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:26:58.022Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 33800, "Time": 1689222418}
2023-07-13T04:26:58.023Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:26:58.023Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 33800}
read bytes:  317 , err:  <nil>
2023-07-13T04:26:58.023Z	DEBUG	proxy/proxy.go:615	the clientConnId: 9
into processing mongo. clientConnId:  9
into test mode. clientConnId:  9
into decode mongo. clientConnId:  9
2023-07-13T04:26:58.023Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 9 and destConnId: 0. requestBuffer: =  &       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 38 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  &       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  9
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  9
the recieved request:   header: &{317 38 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  9
2023-07-13T04:26:58.023Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:26:58.023Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222418
2023-07-13T04:26:58.023Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222418"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 38 0 OP_QUERY} clientConnId: 9

2023-07-13T04:26:58.023Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      &                        %  connectionId    helloOk ismaster 	localTime }Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 9}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:58.023Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 9 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:26:58.025Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1944357}
read bytes:  197 , err:  <nil>
  the clientConnId:  9


 the mongo msg header:  {197 39 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   '       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  9
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  9
the recieved request:   header: &{197 39 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 39 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 39 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  9  and destConnId:  0
the responseTo for the OpMsg: 39
2023-07-13T04:26:58.026Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 9
an iteration of a mongo request lifecycle is completed
2023-07-13T04:26:58.026Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 9 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 40 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   (       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 40 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 40 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 40
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:07.791Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 41 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   )       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 41 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 41 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 41
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:17.793Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  9


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:27:18.043Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 9}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:27:18.043Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20020}
2023-07-13T04:27:18.043Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:27:18.044Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:27:18.045Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:27:18.045Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:27:18.045Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 55062, "Time": 1689222438}
2023-07-13T04:27:18.045Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:27:18.045Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 55062}
read bytes:  317 , err:  <nil>
2023-07-13T04:27:18.046Z	DEBUG	proxy/proxy.go:615	the clientConnId: 48
into processing mongo. clientConnId:  48
into test mode. clientConnId:  48
into decode mongo. clientConnId:  48
2023-07-13T04:27:18.046Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 48 and destConnId: 0. requestBuffer: =  *       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 42 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  *       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  48
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  48
the recieved request:   header: &{317 42 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  48
2023-07-13T04:27:18.046Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:27:18.046Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222438
2023-07-13T04:27:18.047Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222438"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 42 0 OP_QUERY} clientConnId: 48

2023-07-13T04:27:18.047Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      *                        %  connectionId    helloOk ismaster 	localTime &}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 48}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:18.047Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 48 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:27:18.048Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2928179}
read bytes:  197 , err:  <nil>
  the clientConnId:  48


 the mongo msg header:  {197 43 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   +       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  48
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  48
the recieved request:   header: &{197 43 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 43 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 43 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  48  and destConnId:  0
the responseTo for the OpMsg: 43
2023-07-13T04:27:18.051Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 48
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:18.051Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 48 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 44 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ,       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 44 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 44 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 44
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:27.794Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 45 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   -       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 45 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 45 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 45
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:37.796Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  48


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:27:38.066Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 48}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:27:38.067Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20021}
2023-07-13T04:27:38.066Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:27:38.068Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:27:38.068Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:27:38.068Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 34188, "Time": 1689222458}
2023-07-13T04:27:38.068Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:27:38.068Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 34188}
read bytes:  317 , err:  <nil>
2023-07-13T04:27:38.069Z	DEBUG	proxy/proxy.go:615	the clientConnId: 56
into processing mongo. clientConnId:  56
into test mode. clientConnId:  56
into decode mongo. clientConnId:  56
2023-07-13T04:27:38.069Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: =  .       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 46 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  .       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  56
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{317 46 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  56
2023-07-13T04:27:38.069Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:27:38.069Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222458
2023-07-13T04:27:38.069Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222458"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 46 0 OP_QUERY} clientConnId: 56

2023-07-13T04:27:38.069Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      .                        %  connectionId    helloOk ismaster 	localTime :}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 56}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:38.070Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:27:38.070Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2085738}
read bytes:  197 , err:  <nil>
  the clientConnId:  56


 the mongo msg header:  {197 47 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   /       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  56
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{197 47 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 47 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 47 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  56  and destConnId:  0
the responseTo for the OpMsg: 47
2023-07-13T04:27:38.072Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 56
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:38.072Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 48 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   0       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 48 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 48 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 48
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:47.804Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 49 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   1       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 49 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 49 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 49
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:57.800Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:27:58.075Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:27:58.076Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:27:58.076Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:27:58.076Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:27:58.076Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:27:58.077Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
read bytes:  0 , err:  EOF
  the clientConnId:  56
2023-07-13T04:27:58.077Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:27:58.077Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:27:58.077Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:27:58.077Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 56}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:27:58.077Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20008}
2023-07-13T04:27:58.078Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:27:58.078Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:27:58.078Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 55164, "Time": 1689222478}
2023-07-13T04:27:58.078Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:27:58.078Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 55164}
read bytes:  317 , err:  <nil>
2023-07-13T04:27:58.078Z	DEBUG	proxy/proxy.go:615	the clientConnId: 55
into processing mongo. clientConnId:  55
into test mode. clientConnId:  55
into decode mongo. clientConnId:  55
2023-07-13T04:27:58.078Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: =  2       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 50 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  2       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  55
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  55
the recieved request:   header: &{317 50 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  55
2023-07-13T04:27:58.078Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:27:58.079Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222478
2023-07-13T04:27:58.079Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222478"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 50 0 OP_QUERY} clientConnId: 55

2023-07-13T04:27:58.079Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      2                        %  connectionId    helloOk ismaster 	localTime N}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 55}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:58.079Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:27:58.080Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2125289}
read bytes:  197 , err:  <nil>
  the clientConnId:  55


 the mongo msg header:  {197 51 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   3       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  55
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  55
the recieved request:   header: &{197 51 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 51 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 51 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  55  and destConnId:  0
the responseTo for the OpMsg: 51
2023-07-13T04:27:58.081Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 55
an iteration of a mongo request lifecycle is completed
2023-07-13T04:27:58.081Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 52 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   4       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 52 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 52 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 52
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:07.801Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 53 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   5       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 53 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 53 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 53
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:17.803Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  55


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:28:18.103Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 55}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:28:18.103Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20025}
2023-07-13T04:28:18.103Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:28:18.105Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:28:18.105Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:28:18.105Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 35804, "Time": 1689222498}
2023-07-13T04:28:18.105Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:28:18.105Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 35804}
read bytes:  317 , err:  <nil>
2023-07-13T04:28:18.105Z	DEBUG	proxy/proxy.go:615	the clientConnId: 94
into processing mongo. clientConnId:  94
into test mode. clientConnId:  94
into decode mongo. clientConnId:  94
2023-07-13T04:28:18.105Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 94 and destConnId: 0. requestBuffer: =  6       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 54 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  6       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  94
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  94
the recieved request:   header: &{317 54 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  94
2023-07-13T04:28:18.105Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:28:18.105Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222498
2023-07-13T04:28:18.106Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222498"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 54 0 OP_QUERY} clientConnId: 94

2023-07-13T04:28:18.106Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      6                        %  connectionId    helloOk ismaster 	localTime b}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 94}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:18.106Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 94 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:28:18.108Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=3101532}
read bytes:  197 , err:  <nil>
  the clientConnId:  94


 the mongo msg header:  {197 55 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   7       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  94
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  94
the recieved request:   header: &{197 55 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 55 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 55 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  94  and destConnId:  0
the responseTo for the OpMsg: 55
2023-07-13T04:28:18.114Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 94
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:18.114Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 94 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 56 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   8       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 56 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 56 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 56
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:27.804Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 57 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   9       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 57 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 57 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 57
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:37.806Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  94


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:28:38.133Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 94}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:28:38.133Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20027}
2023-07-13T04:28:38.133Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:28:38.135Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:28:38.135Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:28:38.135Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:28:38.135Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:28:38.135Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:28:38.135Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:28:38.136Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:28:38.136Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:28:38.136Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:28:38.136Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:28:38.137Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 57434, "Time": 1689222518}
2023-07-13T04:28:38.137Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:28:38.137Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 57434}
read bytes:  317 , err:  <nil>
2023-07-13T04:28:38.137Z	DEBUG	proxy/proxy.go:615	the clientConnId: 31
into processing mongo. clientConnId:  31
into test mode. clientConnId:  31
into decode mongo. clientConnId:  31
2023-07-13T04:28:38.137Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 31 and destConnId: 0. requestBuffer: =  :       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 58 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  :       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  31
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  31
the recieved request:   header: &{317 58 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  31
2023-07-13T04:28:38.137Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:28:38.137Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222518
2023-07-13T04:28:38.138Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222518"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 58 0 OP_QUERY} clientConnId: 31

2023-07-13T04:28:38.138Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      :                        %  connectionId    helloOk ismaster 	localTime v}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 31}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:38.138Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 31 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:28:38.138Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1889415}
read bytes:  197 , err:  <nil>
  the clientConnId:  31


 the mongo msg header:  {197 59 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ;       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  31
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  31
the recieved request:   header: &{197 59 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 59 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 59 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  31  and destConnId:  0
the responseTo for the OpMsg: 59
2023-07-13T04:28:38.140Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 31
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:38.140Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 31 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 60 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   <       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 60 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 60 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 60
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:47.808Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 61 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   =       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 61 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 61 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 61
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:57.809Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:28:58.159Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  31


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:28:58.160Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 31}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:28:58.160Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:28:58.160Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:28:58.160Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:28:58.160Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 47804, "Time": 1689222538}
2023-07-13T04:28:58.160Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:28:58.160Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 47804}
read bytes:  317 , err:  <nil>
2023-07-13T04:28:58.161Z	DEBUG	proxy/proxy.go:615	the clientConnId: 81
into processing mongo. clientConnId:  81
into test mode. clientConnId:  81
into decode mongo. clientConnId:  81
2023-07-13T04:28:58.161Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 81 and destConnId: 0. requestBuffer: =  >       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 62 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  >       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  81
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  81
the recieved request:   header: &{317 62 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  81
2023-07-13T04:28:58.161Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:28:58.161Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222538
2023-07-13T04:28:58.162Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222538"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 62 0 OP_QUERY} clientConnId: 81

2023-07-13T04:28:58.162Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      >                        %  connectionId    helloOk ismaster 	localTime ä}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 81}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:58.162Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 81 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:28:58.163Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2338229}
read bytes:  197 , err:  <nil>
  the clientConnId:  81


 the mongo msg header:  {197 63 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ?       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  81
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  81
the recieved request:   header: &{197 63 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 63 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 63 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  81  and destConnId:  0
the responseTo for the OpMsg: 63
2023-07-13T04:28:58.168Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 81
an iteration of a mongo request lifecycle is completed
2023-07-13T04:28:58.168Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 81 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 64 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   @       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 64 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 64 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 64
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:07.811Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 65 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   A       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 65 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 65 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 65
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:17.813Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:29:18.187Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  81


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:29:18.188Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 81}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20027}
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:29:18.188Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:29:18.189Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:29:18.189Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:29:18.190Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 33528, "Time": 1689222558}
2023-07-13T04:29:18.190Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:29:18.190Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 33528}
read bytes:  317 , err:  <nil>
2023-07-13T04:29:18.190Z	DEBUG	proxy/proxy.go:615	the clientConnId: 64
into processing mongo. clientConnId:  64
into test mode. clientConnId:  64
into decode mongo. clientConnId:  64
2023-07-13T04:29:18.190Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 64 and destConnId: 0. requestBuffer: =  B       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 66 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  B       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  64
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  64
the recieved request:   header: &{317 66 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  64
2023-07-13T04:29:18.190Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:29:18.190Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222558
2023-07-13T04:29:18.190Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222558"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 66 0 OP_QUERY} clientConnId: 64

2023-07-13T04:29:18.190Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      B                        %  connectionId    helloOk ismaster 	localTime û}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 64}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:18.190Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 64 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:29:18.191Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2012863}
read bytes:  197 , err:  <nil>
  the clientConnId:  64


 the mongo msg header:  {197 67 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   C       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  64
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  64
the recieved request:   header: &{197 67 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 67 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 67 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  64  and destConnId:  0
the responseTo for the OpMsg: 67
2023-07-13T04:29:18.192Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 64
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:18.192Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 64 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 68 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   D       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 68 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 68 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 68
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:27.814Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 69 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   E       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 69 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 69 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 69
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:37.816Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  64


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:29:38.213Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 64}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:29:38.213Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:29:38.213Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:29:38.215Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:29:38.215Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:29:38.215Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 36242, "Time": 1689222578}
2023-07-13T04:29:38.215Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:29:38.215Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 36242}
read bytes:  317 , err:  <nil>
2023-07-13T04:29:38.215Z	DEBUG	proxy/proxy.go:615	the clientConnId: 19
into processing mongo. clientConnId:  19
into test mode. clientConnId:  19
into decode mongo. clientConnId:  19
2023-07-13T04:29:38.215Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: =  F       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 70 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  F       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  19
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{317 70 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  19
2023-07-13T04:29:38.216Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:29:38.216Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222578
2023-07-13T04:29:38.216Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222578"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 70 0 OP_QUERY} clientConnId: 19

2023-07-13T04:29:38.216Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      F                        %  connectionId    helloOk ismaster 	localTime ≤}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 19}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:38.216Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:29:38.217Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2025583}
read bytes:  197 , err:  <nil>
  the clientConnId:  19


 the mongo msg header:  {197 71 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   G       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  19
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{197 71 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 71 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 71 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  19  and destConnId:  0
the responseTo for the OpMsg: 71
2023-07-13T04:29:38.218Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 19
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:38.218Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 72 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   H       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 72 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 72 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 72
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:47.818Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 73 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   I       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 73 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 73 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 73
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:57.819Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  19


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:29:58.227Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 19}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:29:58.227Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20011}
2023-07-13T04:29:58.227Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:29:58.229Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:29:58.230Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:29:58.230Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:29:58.230Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 53738, "Time": 1689222598}
2023-07-13T04:29:58.230Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:29:58.230Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 53738}
read bytes:  317 , err:  <nil>
2023-07-13T04:29:58.230Z	DEBUG	proxy/proxy.go:615	the clientConnId: 19
into processing mongo. clientConnId:  19
into test mode. clientConnId:  19
into decode mongo. clientConnId:  19
2023-07-13T04:29:58.230Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: =  J       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 74 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  J       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  19
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{317 74 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  19
2023-07-13T04:29:58.231Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:29:58.231Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222598
2023-07-13T04:29:58.231Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222598"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 74 0 OP_QUERY} clientConnId: 19

2023-07-13T04:29:58.231Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      J                        %  connectionId    helloOk ismaster 	localTime ∆}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 19}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:58.231Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:29:58.232Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2233227}
read bytes:  197 , err:  <nil>
  the clientConnId:  19


 the mongo msg header:  {197 75 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   K       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  19
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  19
the recieved request:   header: &{197 75 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 75 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 75 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  19  and destConnId:  0
the responseTo for the OpMsg: 75
2023-07-13T04:29:58.235Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 19
an iteration of a mongo request lifecycle is completed
2023-07-13T04:29:58.235Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 19 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 76 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   L       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 76 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 76 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 76
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:07.820Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 77 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   M       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 77 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 77 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 77
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:17.822Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  19


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:30:18.248Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 19}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:30:18.248Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20018}
2023-07-13T04:30:18.248Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:30:18.250Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:30:18.250Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:30:18.250Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 60170, "Time": 1689222618}
2023-07-13T04:30:18.250Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:30:18.250Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 60170}
read bytes:  317 , err:  <nil>
2023-07-13T04:30:18.250Z	DEBUG	proxy/proxy.go:615	the clientConnId: 25
into processing mongo. clientConnId:  25
into test mode. clientConnId:  25
into decode mongo. clientConnId:  25
2023-07-13T04:30:18.250Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 25 and destConnId: 0. requestBuffer: =  N       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 78 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  N       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  25
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  25
the recieved request:   header: &{317 78 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  25
2023-07-13T04:30:18.251Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:30:18.251Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222618
2023-07-13T04:30:18.251Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222618"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 78 0 OP_QUERY} clientConnId: 25

2023-07-13T04:30:18.251Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      N                        %  connectionId    helloOk ismaster 	localTime ⁄}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 25}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:18.251Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 25 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:30:18.252Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1589626}
read bytes:  197 , err:  <nil>
  the clientConnId:  25


 the mongo msg header:  {197 79 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   O       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  25
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  25
the recieved request:   header: &{197 79 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 79 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 79 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  25  and destConnId:  0
the responseTo for the OpMsg: 79
2023-07-13T04:30:18.253Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 25
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:18.253Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 25 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 80 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   P       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 80 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 80 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 80
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:27.823Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 81 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Q       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 81 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 81 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 81
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:37.825Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  25


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:30:38.273Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 25}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:30:38.274Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:30:38.273Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:30:38.275Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:30:38.276Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:30:38.276Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:30:38.276Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 56858, "Time": 1689222638}
2023-07-13T04:30:38.276Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:30:38.276Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 56858}
read bytes:  317 , err:  <nil>
2023-07-13T04:30:38.276Z	DEBUG	proxy/proxy.go:615	the clientConnId: 14
into processing mongo. clientConnId:  14
into test mode. clientConnId:  14
into decode mongo. clientConnId:  14
2023-07-13T04:30:38.276Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 14 and destConnId: 0. requestBuffer: =  R       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 82 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  R       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  14
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  14
the recieved request:   header: &{317 82 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  14
2023-07-13T04:30:38.277Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:30:38.277Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222638
2023-07-13T04:30:38.277Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222638"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 82 0 OP_QUERY} clientConnId: 14

2023-07-13T04:30:38.277Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      R                        %  connectionId    helloOk ismaster 	localTime Ó}Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 14}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:38.277Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 14 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:30:38.278Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2473600}
read bytes:  197 , err:  <nil>
  the clientConnId:  14


 the mongo msg header:  {197 83 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   S       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  14
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  14
the recieved request:   header: &{197 83 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 83 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 83 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  14  and destConnId:  0
the responseTo for the OpMsg: 83
2023-07-13T04:30:38.280Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 14
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:38.280Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 14 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 84 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   T       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 84 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 84 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 84
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:47.826Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 85 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   U       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 85 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 85 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 85
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:57.828Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  14


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:30:58.299Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 14}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:30:58.299Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:30:58.299Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:30:58.301Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:30:58.301Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:30:58.301Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 51766, "Time": 1689222658}
2023-07-13T04:30:58.301Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:30:58.301Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 51766}
read bytes:  317 , err:  <nil>
2023-07-13T04:30:58.301Z	DEBUG	proxy/proxy.go:615	the clientConnId: 55
into processing mongo. clientConnId:  55
into test mode. clientConnId:  55
into decode mongo. clientConnId:  55
2023-07-13T04:30:58.301Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: =  V       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 86 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  V       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  55
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  55
the recieved request:   header: &{317 86 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  55
2023-07-13T04:30:58.302Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:30:58.302Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222658
2023-07-13T04:30:58.302Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222658"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 86 0 OP_QUERY} clientConnId: 55

2023-07-13T04:30:58.303Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      V                        %  connectionId    helloOk ismaster 	localTime ~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 55}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:58.303Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:30:58.303Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2555282}
read bytes:  197 , err:  <nil>
  the clientConnId:  55


 the mongo msg header:  {197 87 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   W       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  55
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  55
the recieved request:   header: &{197 87 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 87 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 87 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  55  and destConnId:  0
the responseTo for the OpMsg: 87
2023-07-13T04:30:58.305Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 55
an iteration of a mongo request lifecycle is completed
2023-07-13T04:30:58.305Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 88 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   X       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 88 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 88 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 88
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:07.831Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 89 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Y       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 89 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 89 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 89
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:17.832Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:31:18.323Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:31:18.324Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
read bytes:  0 , err:  EOF
  the clientConnId:  55


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:31:18.324Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 55}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:31:18.325Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:31:18.325Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:31:18.326Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:31:18.326Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 57204, "Time": 1689222678}
2023-07-13T04:31:18.326Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:31:18.326Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 57204}
read bytes:  317 , err:  <nil>
2023-07-13T04:31:18.326Z	DEBUG	proxy/proxy.go:615	the clientConnId: 52
into processing mongo. clientConnId:  52
into test mode. clientConnId:  52
into decode mongo. clientConnId:  52
2023-07-13T04:31:18.326Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 52 and destConnId: 0. requestBuffer: =  Z       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 90 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Z       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  52
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  52
the recieved request:   header: &{317 90 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  52
2023-07-13T04:31:18.327Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:31:18.327Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222678
2023-07-13T04:31:18.327Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222678"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 90 0 OP_QUERY} clientConnId: 52

2023-07-13T04:31:18.327Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Z                        %  connectionId    helloOk ismaster 	localTime ~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 52}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:18.327Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 52 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:31:18.328Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1952492}
read bytes:  197 , err:  <nil>
  the clientConnId:  52


 the mongo msg header:  {197 91 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   [       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  52
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  52
the recieved request:   header: &{197 91 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 91 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 91 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  52  and destConnId:  0
the responseTo for the OpMsg: 91
2023-07-13T04:31:18.330Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 52
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:18.330Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 52 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 92 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   \       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 92 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 92 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 92
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:27.833Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 93 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ]       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 93 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 93 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 93
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:37.835Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  52


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:31:38.343Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 52}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:31:38.343Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20017}
2023-07-13T04:31:38.343Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:31:38.344Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:31:38.344Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:31:38.344Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 50876, "Time": 1689222698}
2023-07-13T04:31:38.345Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:31:38.345Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 50876}
read bytes:  317 , err:  <nil>
2023-07-13T04:31:38.345Z	DEBUG	proxy/proxy.go:615	the clientConnId: 23
into processing mongo. clientConnId:  23
into test mode. clientConnId:  23
into decode mongo. clientConnId:  23
2023-07-13T04:31:38.345Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 23 and destConnId: 0. requestBuffer: =  ^       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 94 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ^       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  23
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  23
the recieved request:   header: &{317 94 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  23
2023-07-13T04:31:38.345Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:31:38.345Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222698
2023-07-13T04:31:38.345Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222698"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 94 0 OP_QUERY} clientConnId: 23

2023-07-13T04:31:38.345Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ^                        %  connectionId    helloOk ismaster 	localTime *~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 23}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:38.346Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 23 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:31:38.346Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1607027}
read bytes:  197 , err:  <nil>
  the clientConnId:  23


 the mongo msg header:  {197 95 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   _       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  23
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  23
the recieved request:   header: &{197 95 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 95 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 95 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  23  and destConnId:  0
the responseTo for the OpMsg: 95
2023-07-13T04:31:38.347Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 23
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:38.347Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 23 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 96 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   `       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 96 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 96 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 96
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:47.836Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 97 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   a       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 97 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 97 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 97
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:57.838Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:31:58.363Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:31:58.364Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
read bytes:  0 , err:  EOF
  the clientConnId:  23


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:31:58.364Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 23}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:31:58.365Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20020}
2023-07-13T04:31:58.366Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:31:58.366Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:31:58.366Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 36524, "Time": 1689222718}
2023-07-13T04:31:58.366Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:31:58.366Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 36524}
read bytes:  317 , err:  <nil>
2023-07-13T04:31:58.366Z	DEBUG	proxy/proxy.go:615	the clientConnId: 61
into processing mongo. clientConnId:  61
into test mode. clientConnId:  61
into decode mongo. clientConnId:  61
2023-07-13T04:31:58.366Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 61 and destConnId: 0. requestBuffer: =  b       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 98 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  b       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  61
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  61
the recieved request:   header: &{317 98 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  61
2023-07-13T04:31:58.366Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:31:58.367Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222718
2023-07-13T04:31:58.367Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222718"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 98 0 OP_QUERY} clientConnId: 61

2023-07-13T04:31:58.367Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      b                        %  connectionId    helloOk ismaster 	localTime >~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 61}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:58.367Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 61 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:31:58.367Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1963702}
read bytes:  197 , err:  <nil>
  the clientConnId:  61


 the mongo msg header:  {197 99 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   c       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  61
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  61
the recieved request:   header: &{197 99 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 99 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 99 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  61  and destConnId:  0
the responseTo for the OpMsg: 99
2023-07-13T04:31:58.369Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 61
an iteration of a mongo request lifecycle is completed
2023-07-13T04:31:58.369Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 61 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 100 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   d       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 100 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 100 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 100
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:07.839Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 101 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   e       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 101 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 101 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 101
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:17.840Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  61


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:32:18.371Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 61}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:32:18.371Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20005}
2023-07-13T04:32:18.371Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:32:18.373Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:32:18.373Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:32:18.373Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 47298, "Time": 1689222738}
2023-07-13T04:32:18.373Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:32:18.373Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 47298}
read bytes:  317 , err:  <nil>
2023-07-13T04:32:18.373Z	DEBUG	proxy/proxy.go:615	the clientConnId: 79
into processing mongo. clientConnId:  79
into test mode. clientConnId:  79
into decode mongo. clientConnId:  79
2023-07-13T04:32:18.373Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: =  f       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 102 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  f       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  79
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{317 102 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  79
2023-07-13T04:32:18.373Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:32:18.374Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222738
2023-07-13T04:32:18.374Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222738"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 102 0 OP_QUERY} clientConnId: 79

2023-07-13T04:32:18.374Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      f                        %  connectionId    helloOk ismaster 	localTime R~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 79}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:18.374Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:32:18.375Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1821760}
read bytes:  197 , err:  <nil>
  the clientConnId:  79


 the mongo msg header:  {197 103 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   g       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  79
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{197 103 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 103 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 103 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  79  and destConnId:  0
the responseTo for the OpMsg: 103
2023-07-13T04:32:18.376Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 79
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:18.376Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 104 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   h       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 104 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 104 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 104
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:27.842Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 105 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   i       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 105 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 105 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 105
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:37.844Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:32:38.381Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
read bytes:  0 , err:  EOF
  the clientConnId:  79


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:32:38.383Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 79}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:32:38.383Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20010}
2023-07-13T04:32:38.384Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:32:38.384Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:32:38.384Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 47586, "Time": 1689222758}
2023-07-13T04:32:38.384Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:32:38.384Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 47586}
read bytes:  317 , err:  <nil>
2023-07-13T04:32:38.385Z	DEBUG	proxy/proxy.go:615	the clientConnId: 53
into processing mongo. clientConnId:  53
into test mode. clientConnId:  53
into decode mongo. clientConnId:  53
2023-07-13T04:32:38.385Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 53 and destConnId: 0. requestBuffer: =  j       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 106 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  j       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  53
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  53
the recieved request:   header: &{317 106 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  53
2023-07-13T04:32:38.385Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:32:38.385Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222758
2023-07-13T04:32:38.385Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222758"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 106 0 OP_QUERY} clientConnId: 53

2023-07-13T04:32:38.385Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      j                        %  connectionId    helloOk ismaster 	localTime f~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 53}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:38.385Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 53 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:32:38.386Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2171486}
read bytes:  197 , err:  <nil>
  the clientConnId:  53


 the mongo msg header:  {197 107 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   k       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  53
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  53
the recieved request:   header: &{197 107 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 107 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 107 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  53  and destConnId:  0
the responseTo for the OpMsg: 107
2023-07-13T04:32:38.388Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 53
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:38.388Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 53 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 108 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   l       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 108 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 108 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 108
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:47.845Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 109 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   m       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 109 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 109 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 109
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:57.846Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  53


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:32:58.408Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 53}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:32:58.408Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:32:58.407Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:32:58.409Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:32:58.409Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:32:58.409Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 33768, "Time": 1689222778}
2023-07-13T04:32:58.409Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:32:58.409Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 33768}
read bytes:  317 , err:  <nil>
2023-07-13T04:32:58.409Z	DEBUG	proxy/proxy.go:615	the clientConnId: 41
into processing mongo. clientConnId:  41
into test mode. clientConnId:  41
into decode mongo. clientConnId:  41
2023-07-13T04:32:58.409Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: =  n       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 110 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  n       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  41
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{317 110 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  41
2023-07-13T04:32:58.410Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:32:58.410Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222778
2023-07-13T04:32:58.410Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222778"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 110 0 OP_QUERY} clientConnId: 41

2023-07-13T04:32:58.410Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      n                        %  connectionId    helloOk ismaster 	localTime z~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 41}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:58.410Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:32:58.410Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1671637}
read bytes:  197 , err:  <nil>
  the clientConnId:  41


 the mongo msg header:  {197 111 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   o       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  41
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{197 111 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 111 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 111 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  41  and destConnId:  0
the responseTo for the OpMsg: 111
2023-07-13T04:32:58.412Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 41
an iteration of a mongo request lifecycle is completed
2023-07-13T04:32:58.412Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 112 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   p       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 112 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 112 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 112
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:07.848Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 113 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   q       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 113 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 113 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 113
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:17.849Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:33:18.427Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
read bytes:  0 , err:  EOF
  the clientConnId:  41


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:33:18.428Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 41}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:33:18.428Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20019}
2023-07-13T04:33:18.430Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:33:18.430Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:33:18.430Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 40778, "Time": 1689222798}
2023-07-13T04:33:18.430Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:33:18.430Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 40778}
read bytes:  317 , err:  <nil>
2023-07-13T04:33:18.430Z	DEBUG	proxy/proxy.go:615	the clientConnId: 58
into processing mongo. clientConnId:  58
into test mode. clientConnId:  58
into decode mongo. clientConnId:  58
2023-07-13T04:33:18.430Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 58 and destConnId: 0. requestBuffer: =  r       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 114 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  r       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  58
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  58
the recieved request:   header: &{317 114 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  58
2023-07-13T04:33:18.430Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:33:18.430Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222798
2023-07-13T04:33:18.430Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222798"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 114 0 OP_QUERY} clientConnId: 58

2023-07-13T04:33:18.430Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      r                        %  connectionId    helloOk ismaster 	localTime é~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 58}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:18.431Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 58 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:33:18.431Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1782349}
read bytes:  197 , err:  <nil>
  the clientConnId:  58


 the mongo msg header:  {197 115 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   s       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  58
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  58
the recieved request:   header: &{197 115 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 115 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 115 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  58  and destConnId:  0
the responseTo for the OpMsg: 115
2023-07-13T04:33:18.433Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 58
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:18.433Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 58 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 116 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   t       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 116 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 116 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 116
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:27.851Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 117 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   u       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 117 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 117 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 117
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:37.852Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  58


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:33:38.453Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 58}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:33:38.454Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-13T04:33:38.453Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:33:38.455Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:33:38.455Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:33:38.455Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 46994, "Time": 1689222818}
2023-07-13T04:33:38.455Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:33:38.455Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 46994}
read bytes:  317 , err:  <nil>
2023-07-13T04:33:38.455Z	DEBUG	proxy/proxy.go:615	the clientConnId: 55
into processing mongo. clientConnId:  55
into test mode. clientConnId:  55
into decode mongo. clientConnId:  55
2023-07-13T04:33:38.455Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: =  v       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 118 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  v       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  55
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  55
the recieved request:   header: &{317 118 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  55
2023-07-13T04:33:38.456Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:33:38.456Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222818
2023-07-13T04:33:38.456Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222818"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 118 0 OP_QUERY} clientConnId: 55

2023-07-13T04:33:38.456Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      v                        %  connectionId    helloOk ismaster 	localTime ¢~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 55}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:38.456Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:33:38.457Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1441943}
read bytes:  197 , err:  <nil>
  the clientConnId:  55


 the mongo msg header:  {197 119 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   w       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  55
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  55
the recieved request:   header: &{197 119 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 119 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 119 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  55  and destConnId:  0
the responseTo for the OpMsg: 119
2023-07-13T04:33:38.458Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 55
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:38.458Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 55 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 120 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   x       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 120 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 120 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 120
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:47.854Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 121 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   y       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 121 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 121 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 121
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:57.855Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  55


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:33:58.478Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 55}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:33:58.479Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:33:58.478Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:33:58.480Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:33:58.481Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:33:58.481Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:33:58.481Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 52414, "Time": 1689222838}
2023-07-13T04:33:58.481Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:33:58.481Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 52414}
read bytes:  317 , err:  <nil>
2023-07-13T04:33:58.481Z	DEBUG	proxy/proxy.go:615	the clientConnId: 8
into processing mongo. clientConnId:  8
into test mode. clientConnId:  8
into decode mongo. clientConnId:  8
2023-07-13T04:33:58.481Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 8 and destConnId: 0. requestBuffer: =  z       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 122 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  z       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  8
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  8
the recieved request:   header: &{317 122 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  8
2023-07-13T04:33:58.481Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:33:58.482Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222838
2023-07-13T04:33:58.482Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222838"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 122 0 OP_QUERY} clientConnId: 8

2023-07-13T04:33:58.482Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      z                        %  connectionId    helloOk ismaster 	localTime ∂~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 8}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:58.482Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 8 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:33:58.483Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1903231}
read bytes:  197 , err:  <nil>
  the clientConnId:  8


 the mongo msg header:  {197 123 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   {       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  8
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  8
the recieved request:   header: &{197 123 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 123 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 123 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  8  and destConnId:  0
the responseTo for the OpMsg: 123
2023-07-13T04:33:58.484Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 8
an iteration of a mongo request lifecycle is completed
2023-07-13T04:33:58.484Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 8 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 124 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   |       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 124 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 124 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 124
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:07.857Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 125 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   }       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 125 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 125 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 125
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:17.858Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:34:18.493Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  8


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:34:18.494Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 8}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:34:18.495Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20013}
2023-07-13T04:34:18.495Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:34:18.495Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:34:18.495Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 52178, "Time": 1689222858}
2023-07-13T04:34:18.495Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:34:18.495Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 52178}
read bytes:  317 , err:  <nil>
2023-07-13T04:34:18.495Z	DEBUG	proxy/proxy.go:615	the clientConnId: 14
into processing mongo. clientConnId:  14
into test mode. clientConnId:  14
into decode mongo. clientConnId:  14
2023-07-13T04:34:18.495Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 14 and destConnId: 0. requestBuffer: =  ~       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 126 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ~       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  14
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  14
the recieved request:   header: &{317 126 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  14
2023-07-13T04:34:18.496Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:34:18.496Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222858
2023-07-13T04:34:18.496Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222858"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 126 0 OP_QUERY} clientConnId: 14

2023-07-13T04:34:18.496Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ~                        %  connectionId    helloOk ismaster 	localTime  ~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 14}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:18.496Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 14 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:34:18.497Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1617736}
read bytes:  197 , err:  <nil>
  the clientConnId:  14


 the mongo msg header:  {197 127 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈          ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  14
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  14
the recieved request:   header: &{197 127 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 127 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 127 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  14  and destConnId:  0
the responseTo for the OpMsg: 127
2023-07-13T04:34:18.498Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 14
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:18.498Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 14 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 128 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ä       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 128 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 128 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 128
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:27.860Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 129 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Å       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 129 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 129 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 129
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:37.862Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  14


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:34:38.519Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 14}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:34:38.519Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:34:38.519Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:34:38.521Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:34:38.522Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:34:38.522Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:34:38.522Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 49614, "Time": 1689222878}
2023-07-13T04:34:38.522Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:34:38.522Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 49614}
read bytes:  317 , err:  <nil>
2023-07-13T04:34:38.523Z	DEBUG	proxy/proxy.go:615	the clientConnId: 40
into processing mongo. clientConnId:  40
into test mode. clientConnId:  40
into decode mongo. clientConnId:  40
2023-07-13T04:34:38.523Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 40 and destConnId: 0. requestBuffer: =  Ç       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 130 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Ç       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  40
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  40
the recieved request:   header: &{317 130 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  40
2023-07-13T04:34:38.523Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:34:38.523Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222878
2023-07-13T04:34:38.523Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222878"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 130 0 OP_QUERY} clientConnId: 40

2023-07-13T04:34:38.523Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Ç                        %  connectionId    helloOk ismaster 	localTime ﬁ~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 40}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:38.523Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 40 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:34:38.524Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2034903}
read bytes:  197 , err:  <nil>
  the clientConnId:  40


 the mongo msg header:  {197 131 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   É       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  40
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  40
the recieved request:   header: &{197 131 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 131 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 131 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  40  and destConnId:  0
the responseTo for the OpMsg: 131
2023-07-13T04:34:38.527Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 40
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:38.527Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 40 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 132 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ñ       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 132 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 132 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 132
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:47.863Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 133 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ö       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 133 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 133 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 133
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:57.864Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  40


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:34:58.547Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 40}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:34:58.547Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20025}
2023-07-13T04:34:58.547Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:34:58.549Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:34:58.549Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:34:58.549Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 47536, "Time": 1689222898}
2023-07-13T04:34:58.549Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:34:58.549Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 47536}
read bytes:  317 , err:  <nil>
2023-07-13T04:34:58.549Z	DEBUG	proxy/proxy.go:615	the clientConnId: 42
into processing mongo. clientConnId:  42
into test mode. clientConnId:  42
into decode mongo. clientConnId:  42
2023-07-13T04:34:58.549Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 42 and destConnId: 0. requestBuffer: =  Ü       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 134 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Ü       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  42
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  42
the recieved request:   header: &{317 134 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  42
2023-07-13T04:34:58.550Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:34:58.550Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222898
2023-07-13T04:34:58.550Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222898"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 134 0 OP_QUERY} clientConnId: 42

2023-07-13T04:34:58.550Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Ü                        %  connectionId    helloOk ismaster 	localTime Ú~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 42}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:58.550Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 42 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:34:58.551Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1607616}
read bytes:  197 , err:  <nil>
  the clientConnId:  42


 the mongo msg header:  {197 135 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   á       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  42
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  42
the recieved request:   header: &{197 135 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 135 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 135 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  42  and destConnId:  0
the responseTo for the OpMsg: 135
2023-07-13T04:34:58.552Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 42
an iteration of a mongo request lifecycle is completed
2023-07-13T04:34:58.552Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 42 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 136 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   à       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 136 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 136 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 136
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:07.866Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 137 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   â       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 137 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 137 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 137
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:17.867Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  42


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:35:18.566Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 42}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:35:18.567Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20017}
2023-07-13T04:35:18.567Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:35:18.568Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:35:18.569Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:35:18.569Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:35:18.569Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 59270, "Time": 1689222918}
2023-07-13T04:35:18.569Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:35:18.569Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 59270}
read bytes:  317 , err:  <nil>
2023-07-13T04:35:18.570Z	DEBUG	proxy/proxy.go:615	the clientConnId: 2
into processing mongo. clientConnId:  2
into test mode. clientConnId:  2
into decode mongo. clientConnId:  2
2023-07-13T04:35:18.570Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 2 and destConnId: 0. requestBuffer: =  ä       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 138 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ä       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  2
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  2
the recieved request:   header: &{317 138 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  2
2023-07-13T04:35:18.570Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:35:18.570Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222918
2023-07-13T04:35:18.570Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222918"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 138 0 OP_QUERY} clientConnId: 2

2023-07-13T04:35:18.570Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ä                        %  connectionId    helloOk ismaster 	localTime Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 2}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:18.570Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 2 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:35:18.571Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1772619}
read bytes:  197 , err:  <nil>
  the clientConnId:  2


 the mongo msg header:  {197 139 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ã       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  2
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  2
the recieved request:   header: &{197 139 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 139 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 139 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  2  and destConnId:  0
the responseTo for the OpMsg: 139
2023-07-13T04:35:18.572Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 2
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:18.572Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 2 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 140 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   å       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 140 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 140 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 140
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:27.868Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 141 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ç       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 141 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 141 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 141
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:37.869Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:35:38.592Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:35:38.594Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:35:38.594Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:35:38.594Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 46026, "Time": 1689222938}
2023-07-13T04:35:38.594Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:35:38.594Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 46026}
read bytes:  317 , err:  <nil>
2023-07-13T04:35:38.594Z	DEBUG	proxy/proxy.go:615	the clientConnId: 22
into processing mongo. clientConnId:  22
into test mode. clientConnId:  22
into decode mongo. clientConnId:  22
2023-07-13T04:35:38.594Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 22 and destConnId: 0. requestBuffer: =  é       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 142 0 OP_QUERY} 
 
read bytes:  0 , err:  EOF
  the clientConnId:  2


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
2023-07-13T04:35:38.594Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 2}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  é       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  22
2023-07-13T04:35:38.595Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20025}
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  22
the recieved request:   header: &{317 142 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  22
2023-07-13T04:35:38.595Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:35:38.595Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222938
2023-07-13T04:35:38.595Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222938"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 142 0 OP_QUERY} clientConnId: 22

2023-07-13T04:35:38.595Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      é                        %  connectionId    helloOk ismaster 	localTime Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 22}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:38.595Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 22 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:35:38.596Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2038313}
read bytes:  197 , err:  <nil>
  the clientConnId:  22


 the mongo msg header:  {197 143 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   è       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  22
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  22
the recieved request:   header: &{197 143 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 143 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 143 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  22  and destConnId:  0
the responseTo for the OpMsg: 143
2023-07-13T04:35:38.597Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 22
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:38.597Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 22 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 144 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ê       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 144 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 144 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 144
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:47.871Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 145 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ë       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 145 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 145 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 145
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:57.872Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  22


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:35:58.599Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 22}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:35:58.600Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20005}
2023-07-13T04:35:58.599Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:35:58.601Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:35:58.602Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:35:58.602Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:35:58.602Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 45290, "Time": 1689222958}
2023-07-13T04:35:58.602Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:35:58.603Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 45290}
read bytes:  317 , err:  <nil>
2023-07-13T04:35:58.603Z	DEBUG	proxy/proxy.go:615	the clientConnId: 56
into processing mongo. clientConnId:  56
into test mode. clientConnId:  56
into decode mongo. clientConnId:  56
2023-07-13T04:35:58.603Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: =  í       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 146 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  í       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  56
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{317 146 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  56
2023-07-13T04:35:58.603Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:35:58.603Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222958
2023-07-13T04:35:58.603Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222958"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 146 0 OP_QUERY} clientConnId: 56

2023-07-13T04:35:58.603Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      í                        %  connectionId    helloOk ismaster 	localTime .Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 56}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:58.603Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:35:58.604Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1899511}
read bytes:  197 , err:  <nil>
  the clientConnId:  56


 the mongo msg header:  {197 147 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ì       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  56
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{197 147 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 147 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 147 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  56  and destConnId:  0
the responseTo for the OpMsg: 147
2023-07-13T04:35:58.605Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 56
an iteration of a mongo request lifecycle is completed
2023-07-13T04:35:58.605Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 148 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   î       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 148 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 148 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 148
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:07.873Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 149 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ï       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 149 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 149 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 149
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:17.875Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  56


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:36:18.621Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 56}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:36:18.621Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20018}
2023-07-13T04:36:18.621Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:36:18.623Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:36:18.623Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:36:18.623Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 54346, "Time": 1689222978}
2023-07-13T04:36:18.623Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:36:18.623Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 54346}
read bytes:  317 , err:  <nil>
2023-07-13T04:36:18.623Z	DEBUG	proxy/proxy.go:615	the clientConnId: 24
into processing mongo. clientConnId:  24
into test mode. clientConnId:  24
into decode mongo. clientConnId:  24
2023-07-13T04:36:18.624Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 24 and destConnId: 0. requestBuffer: =  ñ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 150 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ñ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  24
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  24
the recieved request:   header: &{317 150 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  24
2023-07-13T04:36:18.624Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:36:18.624Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222978
2023-07-13T04:36:18.624Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222978"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 150 0 OP_QUERY} clientConnId: 24

2023-07-13T04:36:18.624Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ñ                        %  connectionId    helloOk ismaster 	localTime BØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 24}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:18.624Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 24 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:36:18.625Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1690117}
read bytes:  197 , err:  <nil>
  the clientConnId:  24


 the mongo msg header:  {197 151 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ó       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  24
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  24
the recieved request:   header: &{197 151 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 151 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 151 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  24  and destConnId:  0
the responseTo for the OpMsg: 151
2023-07-13T04:36:18.626Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 24
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:18.626Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 24 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 152 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ò       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 152 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 152 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 152
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:27.876Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 153 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ô       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 153 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 153 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 153
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:37.877Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  24


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:36:38.646Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 24}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:36:38.646Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:36:38.646Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:36:38.647Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:36:38.648Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:36:38.648Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:36:38.648Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 39080, "Time": 1689222998}
2023-07-13T04:36:38.648Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:36:38.648Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 39080}
read bytes:  317 , err:  <nil>
2023-07-13T04:36:38.648Z	DEBUG	proxy/proxy.go:615	the clientConnId: 3
into processing mongo. clientConnId:  3
into test mode. clientConnId:  3
into decode mongo. clientConnId:  3
2023-07-13T04:36:38.648Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 3 and destConnId: 0. requestBuffer: =  ö       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 154 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ö       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  3
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  3
the recieved request:   header: &{317 154 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  3
2023-07-13T04:36:38.649Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:36:38.649Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689222998
2023-07-13T04:36:38.649Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689222998"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 154 0 OP_QUERY} clientConnId: 3

2023-07-13T04:36:38.649Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ö                        %  connectionId    helloOk ismaster 	localTime VØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 3}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:38.649Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 3 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:36:38.650Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1803209}
read bytes:  197 , err:  <nil>
  the clientConnId:  3


 the mongo msg header:  {197 155 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   õ       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  3
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  3
the recieved request:   header: &{197 155 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 155 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 155 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  3  and destConnId:  0
the responseTo for the OpMsg: 155
2023-07-13T04:36:38.651Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 3
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:38.651Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 3 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 156 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ú       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 156 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 156 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 156
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:47.879Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 157 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ù       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 157 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 157 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 157
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:57.880Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:36:58.661Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  3


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:36:58.663Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 3}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:36:58.663Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20014}
2023-07-13T04:36:58.663Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:36:58.663Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:36:58.663Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 37666, "Time": 1689223018}
2023-07-13T04:36:58.663Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:36:58.663Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 37666}
read bytes:  317 , err:  <nil>
2023-07-13T04:36:58.663Z	DEBUG	proxy/proxy.go:615	the clientConnId: 30
into processing mongo. clientConnId:  30
into test mode. clientConnId:  30
into decode mongo. clientConnId:  30
2023-07-13T04:36:58.663Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 30 and destConnId: 0. requestBuffer: =  û       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 158 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  û       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  30
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  30
the recieved request:   header: &{317 158 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  30
2023-07-13T04:36:58.664Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:36:58.664Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223018
2023-07-13T04:36:58.664Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223018"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 158 0 OP_QUERY} clientConnId: 30

2023-07-13T04:36:58.664Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      û                        %  connectionId    helloOk ismaster 	localTime jØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 30}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:58.664Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 30 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:36:58.665Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1801460}
read bytes:  197 , err:  <nil>
  the clientConnId:  30


 the mongo msg header:  {197 159 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ü       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  30
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  30
the recieved request:   header: &{197 159 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 159 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 159 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  30  and destConnId:  0
the responseTo for the OpMsg: 159
2023-07-13T04:36:58.666Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 30
an iteration of a mongo request lifecycle is completed
2023-07-13T04:36:58.666Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 30 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 160 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   †       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 160 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 160 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 160
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:07.881Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 161 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   °       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 161 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 161 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 161
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:17.882Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  30


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:37:18.686Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 30}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:37:18.687Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:37:18.686Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:37:18.688Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:37:18.689Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:37:18.689Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:37:18.689Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 35556, "Time": 1689223038}
2023-07-13T04:37:18.689Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:37:18.689Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 35556}
read bytes:  317 , err:  <nil>
2023-07-13T04:37:18.689Z	DEBUG	proxy/proxy.go:615	the clientConnId: 0
into processing mongo. clientConnId:  0
into test mode. clientConnId:  0
into decode mongo. clientConnId:  0
2023-07-13T04:37:18.689Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: =  ¢       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 162 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ¢       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  0
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  0
the recieved request:   header: &{317 162 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  0
2023-07-13T04:37:18.689Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:37:18.690Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223038
2023-07-13T04:37:18.690Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223038"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 162 0 OP_QUERY} clientConnId: 0

2023-07-13T04:37:18.690Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ¢                        %  connectionId    helloOk ismaster 	localTime ~Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 0}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:18.690Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:37:18.690Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1618326}
read bytes:  197 , err:  <nil>
  the clientConnId:  0


 the mongo msg header:  {197 163 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   £       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  0
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  0
the recieved request:   header: &{197 163 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 163 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 163 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  0  and destConnId:  0
the responseTo for the OpMsg: 163
2023-07-13T04:37:18.692Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 0
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:18.692Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 164 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   §       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 164 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 164 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 164
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:27.883Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 165 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   •       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 165 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 165 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 165
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:37.885Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:37:38.712Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  0


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:37:38.713Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 0}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:37:38.713Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-13T04:37:38.714Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:37:38.714Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:37:38.714Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 49414, "Time": 1689223058}
2023-07-13T04:37:38.714Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:37:38.714Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 49414}
read bytes:  317 , err:  <nil>
2023-07-13T04:37:38.714Z	DEBUG	proxy/proxy.go:615	the clientConnId: 4
into processing mongo. clientConnId:  4
into test mode. clientConnId:  4
into decode mongo. clientConnId:  4
2023-07-13T04:37:38.714Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 4 and destConnId: 0. requestBuffer: =  ¶       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 166 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ¶       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  4
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  4
the recieved request:   header: &{317 166 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  4
2023-07-13T04:37:38.715Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:37:38.715Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223058
2023-07-13T04:37:38.715Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223058"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 166 0 OP_QUERY} clientConnId: 4

2023-07-13T04:37:38.715Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ¶                        %  connectionId    helloOk ismaster 	localTime íØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 4}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:38.715Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 4 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:37:38.716Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2252467}
read bytes:  197 , err:  <nil>
  the clientConnId:  4


 the mongo msg header:  {197 167 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ß       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  4
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  4
the recieved request:   header: &{197 167 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 167 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 167 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  4  and destConnId:  0
the responseTo for the OpMsg: 167
2023-07-13T04:37:38.717Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 4
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:38.717Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 4 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 168 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ®       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 168 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 168 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 168
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:47.887Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 169 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ©       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 169 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 169 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 169
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:57.889Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:37:58.737Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
read bytes:  0 , err:  EOF
  the clientConnId:  4
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:37:58.739Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 4}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:37:58.739Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20025}
2023-07-13T04:37:58.740Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:37:58.740Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:37:58.740Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 53332, "Time": 1689223078}
2023-07-13T04:37:58.740Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:37:58.740Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 53332}
read bytes:  317 , err:  <nil>
2023-07-13T04:37:58.740Z	DEBUG	proxy/proxy.go:615	the clientConnId: 0
into processing mongo. clientConnId:  0
into test mode. clientConnId:  0
into decode mongo. clientConnId:  0
2023-07-13T04:37:58.740Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: =  ™       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 170 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ™       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  0
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  0
the recieved request:   header: &{317 170 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  0
2023-07-13T04:37:58.740Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:37:58.741Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223078
2023-07-13T04:37:58.741Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223078"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 170 0 OP_QUERY} clientConnId: 0

2023-07-13T04:37:58.741Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ™                        %  connectionId    helloOk ismaster 	localTime ¶Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 0}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:58.741Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:37:58.742Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2336689}
read bytes:  197 , err:  <nil>
  the clientConnId:  0


 the mongo msg header:  {197 171 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ´       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  0
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  0
the recieved request:   header: &{197 171 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 171 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 171 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  0  and destConnId:  0
the responseTo for the OpMsg: 171
2023-07-13T04:37:58.744Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 0
an iteration of a mongo request lifecycle is completed
2023-07-13T04:37:58.744Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 172 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ¨       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 172 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 172 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 172
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:07.890Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 173 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ≠       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 173 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 173 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 173
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:17.892Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  0


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:38:18.764Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 0}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:38:18.764Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-13T04:38:18.764Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:38:18.766Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:38:18.766Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:38:18.766Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42922, "Time": 1689223098}
2023-07-13T04:38:18.766Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:38:18.766Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42922}
read bytes:  317 , err:  <nil>
2023-07-13T04:38:18.766Z	DEBUG	proxy/proxy.go:615	the clientConnId: 78
into processing mongo. clientConnId:  78
into test mode. clientConnId:  78
into decode mongo. clientConnId:  78
2023-07-13T04:38:18.766Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 78 and destConnId: 0. requestBuffer: =  Æ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 174 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Æ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  78
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  78
the recieved request:   header: &{317 174 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  78
2023-07-13T04:38:18.767Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:38:18.767Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223098
2023-07-13T04:38:18.767Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223098"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 174 0 OP_QUERY} clientConnId: 78

2023-07-13T04:38:18.767Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Æ                        %  connectionId    helloOk ismaster 	localTime ∫Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 78}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:18.767Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 78 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:38:18.767Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1748329}
read bytes:  197 , err:  <nil>
  the clientConnId:  78


 the mongo msg header:  {197 175 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   Ø       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  78
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  78
the recieved request:   header: &{197 175 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 175 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 175 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  78  and destConnId:  0
the responseTo for the OpMsg: 175
2023-07-13T04:38:18.769Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 78
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:18.769Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 78 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 176 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ∞       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 176 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 176 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 176
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:27.893Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 177 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ±       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 177 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 177 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 177
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:37.894Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  78


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:38:38.779Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 78}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:38:38.780Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20013}
2023-07-13T04:38:38.780Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:38:38.781Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:38:38.781Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:38:38.781Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:38:38.781Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:38:38.781Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:38:38.781Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:38:38.782Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:38:38.782Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:38:38.782Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:38:38.782Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:38:38.782Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 50612, "Time": 1689223118}
2023-07-13T04:38:38.782Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:38:38.782Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 50612}
read bytes:  317 , err:  <nil>
2023-07-13T04:38:38.783Z	DEBUG	proxy/proxy.go:615	the clientConnId: 44
into processing mongo. clientConnId:  44
into test mode. clientConnId:  44
into decode mongo. clientConnId:  44
2023-07-13T04:38:38.783Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 44 and destConnId: 0. requestBuffer: =  ≤       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 178 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ≤       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  44
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  44
the recieved request:   header: &{317 178 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  44
2023-07-13T04:38:38.783Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:38:38.783Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223118
2023-07-13T04:38:38.783Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223118"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 178 0 OP_QUERY} clientConnId: 44

2023-07-13T04:38:38.783Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ≤                        %  connectionId    helloOk ismaster 	localTime ŒØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 44}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:38.783Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 44 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:38:38.784Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1531655}
read bytes:  197 , err:  <nil>
  the clientConnId:  44


 the mongo msg header:  {197 179 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ≥       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  44
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  44
the recieved request:   header: &{197 179 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 179 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 179 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  44  and destConnId:  0
the responseTo for the OpMsg: 179
2023-07-13T04:38:38.785Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 44
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:38.785Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 44 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 180 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ¥       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 180 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 180 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 180
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:47.895Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 181 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   µ       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 181 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 181 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 181
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:57.897Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  44


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:38:58.801Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 44}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:38:58.801Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20018}
2023-07-13T04:38:58.801Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:38:58.803Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:38:58.803Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:38:58.803Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 51334, "Time": 1689223138}
2023-07-13T04:38:58.803Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:38:58.804Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 51334}
read bytes:  317 , err:  <nil>
2023-07-13T04:38:58.804Z	DEBUG	proxy/proxy.go:615	the clientConnId: 91
into processing mongo. clientConnId:  91
into test mode. clientConnId:  91
into decode mongo. clientConnId:  91
2023-07-13T04:38:58.804Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 91 and destConnId: 0. requestBuffer: =  ∂       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 182 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ∂       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  91
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  91
the recieved request:   header: &{317 182 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  91
2023-07-13T04:38:58.804Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:38:58.804Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223138
2023-07-13T04:38:58.804Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223138"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 182 0 OP_QUERY} clientConnId: 91

2023-07-13T04:38:58.804Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ∂                        %  connectionId    helloOk ismaster 	localTime ‚Ød    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 91}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:58.804Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 91 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:38:58.805Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2021923}
read bytes:  197 , err:  <nil>
  the clientConnId:  91


 the mongo msg header:  {197 183 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ∑       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  91
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  91
the recieved request:   header: &{197 183 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 183 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 183 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  91  and destConnId:  0
the responseTo for the OpMsg: 183
2023-07-13T04:38:58.806Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 91
an iteration of a mongo request lifecycle is completed
2023-07-13T04:38:58.807Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 91 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 184 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ∏       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 184 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 184 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 184
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:07.898Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 185 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   π       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 185 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 185 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 185
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:17.899Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:39:18.815Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
read bytes:  0 , err:  EOF
  the clientConnId:  91


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:39:18.816Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 91}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:39:18.816Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20013}
2023-07-13T04:39:18.819Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:39:18.819Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:39:18.819Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 50110, "Time": 1689223158}
2023-07-13T04:39:18.819Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:39:18.819Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 50110}
read bytes:  317 , err:  <nil>
2023-07-13T04:39:18.819Z	DEBUG	proxy/proxy.go:615	the clientConnId: 17
into processing mongo. clientConnId:  17
into test mode. clientConnId:  17
into decode mongo. clientConnId:  17
2023-07-13T04:39:18.819Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 17 and destConnId: 0. requestBuffer: =  ∫       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 186 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ∫       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  17
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  17
the recieved request:   header: &{317 186 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  17
2023-07-13T04:39:18.819Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:39:18.819Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223158
2023-07-13T04:39:18.820Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223158"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 186 0 OP_QUERY} clientConnId: 17

2023-07-13T04:39:18.820Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ∫                        %  connectionId    helloOk ismaster 	localTime ˆØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 17}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:18.820Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 17 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:39:18.820Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1431103}
read bytes:  197 , err:  <nil>
  the clientConnId:  17


 the mongo msg header:  {197 187 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ª       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  17
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  17
the recieved request:   header: &{197 187 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 187 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 187 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  17  and destConnId:  0
the responseTo for the OpMsg: 187
2023-07-13T04:39:18.821Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 17
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:18.821Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 17 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 188 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   º       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 188 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 188 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 188
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:27.900Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 189 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ω       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 189 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 189 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 189
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:37.902Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  17


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:39:38.832Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 17}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:39:38.832Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20012}
2023-07-13T04:39:38.831Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:39:38.833Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:39:38.833Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:39:38.833Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 37512, "Time": 1689223178}
2023-07-13T04:39:38.833Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:39:38.833Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 37512}
read bytes:  317 , err:  <nil>
2023-07-13T04:39:38.833Z	DEBUG	proxy/proxy.go:615	the clientConnId: 68
into processing mongo. clientConnId:  68
into test mode. clientConnId:  68
into decode mongo. clientConnId:  68
2023-07-13T04:39:38.833Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: =  æ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 190 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  æ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  68
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  68
the recieved request:   header: &{317 190 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  68
2023-07-13T04:39:38.834Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:39:38.834Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223178
2023-07-13T04:39:38.834Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223178"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 190 0 OP_QUERY} clientConnId: 68

2023-07-13T04:39:38.834Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      æ                        %  connectionId    helloOk ismaster 	localTime 
ÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 68}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:38.834Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:39:38.835Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1639467}
read bytes:  197 , err:  <nil>
  the clientConnId:  68


 the mongo msg header:  {197 191 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ø       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  68
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  68
the recieved request:   header: &{197 191 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 191 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 191 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  68  and destConnId:  0
the responseTo for the OpMsg: 191
2023-07-13T04:39:38.836Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 68
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:38.836Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:39:43.743Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:39:43.743Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:39:43.743Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "1.ubuntu.pool.ntp.org."}
2023-07-13T04:39:43.744Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:39:43.744Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:39:43.744Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "1.ubuntu.pool.ntp.org."}
2023-07-13T04:39:43.744Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:39:43.744Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:39:43.744Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "1.ubuntu.pool.ntp.org."}
2023-07-13T04:39:44.744Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup 1.ubuntu.pool.ntp.org: i/o timeout"}
2023-07-13T04:39:44.744Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:39:44.744Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:39:44.744Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup 1.ubuntu.pool.ntp.org: i/o timeout"}
2023-07-13T04:39:44.744Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:39:44.744Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:39:44.744Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup 1.ubuntu.pool.ntp.org: i/o timeout"}
2023-07-13T04:39:44.745Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:39:44.745Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 192 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ¿       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 192 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 192 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 192
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:47.903Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 193 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ¡       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 193 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 193 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 193
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:57.905Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:39:58.856Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
read bytes:  0 , err:  EOF
  the clientConnId:  68


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:39:58.858Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 68}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:39:58.858Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-13T04:39:58.859Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:39:58.859Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:39:58.859Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 56990, "Time": 1689223198}
2023-07-13T04:39:58.859Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:39:58.859Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 56990}
read bytes:  317 , err:  <nil>
2023-07-13T04:39:58.859Z	DEBUG	proxy/proxy.go:615	the clientConnId: 91
into processing mongo. clientConnId:  91
into test mode. clientConnId:  91
into decode mongo. clientConnId:  91
2023-07-13T04:39:58.859Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 91 and destConnId: 0. requestBuffer: =  ¬       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 194 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ¬       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  91
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  91
the recieved request:   header: &{317 194 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  91
2023-07-13T04:39:58.860Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:39:58.860Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223198
2023-07-13T04:39:58.860Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223198"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 194 0 OP_QUERY} clientConnId: 91

2023-07-13T04:39:58.860Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ¬                        %  connectionId    helloOk ismaster 	localTime ÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 91}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:58.860Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 91 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:39:58.860Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1608527}
read bytes:  197 , err:  <nil>
  the clientConnId:  91


 the mongo msg header:  {197 195 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   √       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  91
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  91
the recieved request:   header: &{197 195 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 195 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 195 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  91  and destConnId:  0
the responseTo for the OpMsg: 195
2023-07-13T04:39:58.861Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 91
an iteration of a mongo request lifecycle is completed
2023-07-13T04:39:58.861Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 91 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 196 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ƒ       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 196 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 196 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 196
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:07.906Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 197 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ≈       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 197 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 197 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 197
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:17.907Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  91


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:40:18.882Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 91}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:40:18.882Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:40:18.881Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:40:18.883Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:40:18.883Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:40:18.883Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 43810, "Time": 1689223218}
2023-07-13T04:40:18.883Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:40:18.883Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 43810}
read bytes:  317 , err:  <nil>
2023-07-13T04:40:18.884Z	DEBUG	proxy/proxy.go:615	the clientConnId: 0
into processing mongo. clientConnId:  0
into test mode. clientConnId:  0
into decode mongo. clientConnId:  0
2023-07-13T04:40:18.884Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: =  ∆       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 198 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ∆       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  0
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  0
the recieved request:   header: &{317 198 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  0
2023-07-13T04:40:18.884Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:40:18.884Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223218
2023-07-13T04:40:18.884Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223218"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 198 0 OP_QUERY} clientConnId: 0

2023-07-13T04:40:18.884Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ∆                        %  connectionId    helloOk ismaster 	localTime 2ÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 0}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:18.884Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:40:18.885Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1699218}
read bytes:  197 , err:  <nil>
  the clientConnId:  0


 the mongo msg header:  {197 199 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   «       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  0
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  0
the recieved request:   header: &{197 199 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 199 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 199 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  0  and destConnId:  0
the responseTo for the OpMsg: 199
2023-07-13T04:40:18.886Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 0
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:18.886Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 0 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 200 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   »       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 200 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 200 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 200
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:27.908Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 201 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   …       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 201 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 201 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 201
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:37.910Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  0


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:40:38.906Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 0}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:40:38.907Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:40:38.906Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:40:38.908Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:40:38.908Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:40:38.908Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 41134, "Time": 1689223238}
2023-07-13T04:40:38.909Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:40:38.909Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 41134}
read bytes:  317 , err:  <nil>
2023-07-13T04:40:38.910Z	DEBUG	proxy/proxy.go:615	the clientConnId: 97
into processing mongo. clientConnId:  97
into test mode. clientConnId:  97
into decode mongo. clientConnId:  97
2023-07-13T04:40:38.910Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 97 and destConnId: 0. requestBuffer: =          ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 202 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =          ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  97
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  97
the recieved request:   header: &{317 202 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  97
2023-07-13T04:40:38.910Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:40:38.910Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223238
2023-07-13T04:40:38.911Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223238"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 202 0 OP_QUERY} clientConnId: 97

2023-07-13T04:40:38.911Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                               %  connectionId    helloOk ismaster 	localTime FÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 97}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:38.911Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 97 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:40:38.911Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1503475}
read bytes:  197 , err:  <nil>
  the clientConnId:  97


 the mongo msg header:  {197 203 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   À       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  97
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  97
the recieved request:   header: &{197 203 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 203 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 203 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  97  and destConnId:  0
the responseTo for the OpMsg: 203
2023-07-13T04:40:38.913Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 97
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:38.913Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 97 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 204 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ã       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 204 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 204 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 204
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:47.911Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 205 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Õ       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 205 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 205 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 205
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:57.915Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:40:58.916Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  97


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:40:58.918Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 97}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:40:58.918Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20008}
2023-07-13T04:40:58.919Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:40:58.919Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:40:58.919Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 44146, "Time": 1689223258}
2023-07-13T04:40:58.919Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:40:58.919Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 44146}
read bytes:  317 , err:  <nil>
2023-07-13T04:40:58.919Z	DEBUG	proxy/proxy.go:615	the clientConnId: 12
into processing mongo. clientConnId:  12
into test mode. clientConnId:  12
into decode mongo. clientConnId:  12
2023-07-13T04:40:58.919Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 12 and destConnId: 0. requestBuffer: =  Œ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 206 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Œ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  12
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  12
the recieved request:   header: &{317 206 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  12
2023-07-13T04:40:58.919Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:40:58.919Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223258
2023-07-13T04:40:58.919Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223258"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 206 0 OP_QUERY} clientConnId: 12

2023-07-13T04:40:58.920Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Œ                        %  connectionId    helloOk ismaster 	localTime ZÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 12}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:58.920Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 12 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:40:58.920Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1989302}
read bytes:  197 , err:  <nil>
  the clientConnId:  12


 the mongo msg header:  {197 207 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   œ       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  12
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  12
the recieved request:   header: &{197 207 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 207 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 207 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  12  and destConnId:  0
the responseTo for the OpMsg: 207
2023-07-13T04:40:58.922Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 12
an iteration of a mongo request lifecycle is completed
2023-07-13T04:40:58.922Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 12 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 208 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   –       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 208 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 208 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 208
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:07.916Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 209 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   —       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 209 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 209 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 209
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:17.917Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  12


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:41:18.939Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 12}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:41:18.939Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20020}
2023-07-13T04:41:18.939Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:41:18.940Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:41:18.941Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:41:18.942Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42136, "Time": 1689223278}
2023-07-13T04:41:18.942Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:41:18.942Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42136}
read bytes:  317 , err:  <nil>
2023-07-13T04:41:18.942Z	DEBUG	proxy/proxy.go:615	the clientConnId: 41
into processing mongo. clientConnId:  41
into test mode. clientConnId:  41
into decode mongo. clientConnId:  41
2023-07-13T04:41:18.942Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: =  “       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 210 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  “       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  41
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{317 210 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  41
2023-07-13T04:41:18.942Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:41:18.942Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223278
2023-07-13T04:41:18.942Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223278"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 210 0 OP_QUERY} clientConnId: 41

2023-07-13T04:41:18.943Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      “                        %  connectionId    helloOk ismaster 	localTime nÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 41}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:18.943Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:41:18.943Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1630217}
read bytes:  197 , err:  <nil>
  the clientConnId:  41


 the mongo msg header:  {197 211 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ”       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  41
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{197 211 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 211 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 211 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  41  and destConnId:  0
the responseTo for the OpMsg: 211
2023-07-13T04:41:18.944Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 41
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:18.944Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 212 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ‘       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 212 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 212 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 212
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:27.919Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 213 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ’       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 213 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 213 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 213
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:37.920Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  41


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:41:38.950Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 41}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:41:38.951Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20009}
2023-07-13T04:41:38.951Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:41:38.952Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:41:38.952Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:41:38.952Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 54176, "Time": 1689223298}
2023-07-13T04:41:38.952Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:41:38.952Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 54176}
read bytes:  317 , err:  <nil>
2023-07-13T04:41:38.952Z	DEBUG	proxy/proxy.go:615	the clientConnId: 85
into processing mongo. clientConnId:  85
into test mode. clientConnId:  85
into decode mongo. clientConnId:  85
2023-07-13T04:41:38.952Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 85 and destConnId: 0. requestBuffer: =  ÷       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 214 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ÷       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  85
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  85
the recieved request:   header: &{317 214 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  85
2023-07-13T04:41:38.953Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:41:38.953Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223298
2023-07-13T04:41:38.953Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223298"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 214 0 OP_QUERY} clientConnId: 85

2023-07-13T04:41:38.953Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ÷                        %  connectionId    helloOk ismaster 	localTime ÇÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 85}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:38.953Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 85 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:41:38.954Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1589726}
read bytes:  197 , err:  <nil>
  the clientConnId:  85


 the mongo msg header:  {197 215 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ◊       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  85
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  85
the recieved request:   header: &{197 215 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 215 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 215 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  85  and destConnId:  0
the responseTo for the OpMsg: 215
2023-07-13T04:41:38.955Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 85
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:38.955Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 85 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 216 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ÿ       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 216 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 216 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 216
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:47.922Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 217 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ÿ       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 217 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 217 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 217
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:57.924Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  85


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:41:58.975Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 85}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:41:58.975Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:41:58.975Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:41:58.977Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:41:58.978Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:41:58.978Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:41:58.978Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 43272, "Time": 1689223318}
2023-07-13T04:41:58.978Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:41:58.978Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 43272}
read bytes:  317 , err:  <nil>
2023-07-13T04:41:58.978Z	DEBUG	proxy/proxy.go:615	the clientConnId: 52
into processing mongo. clientConnId:  52
into test mode. clientConnId:  52
into decode mongo. clientConnId:  52
2023-07-13T04:41:58.978Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 52 and destConnId: 0. requestBuffer: =  ⁄       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 218 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ⁄       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  52
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  52
the recieved request:   header: &{317 218 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  52
2023-07-13T04:41:58.978Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:41:58.979Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223318
2023-07-13T04:41:58.979Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223318"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 218 0 OP_QUERY} clientConnId: 52

2023-07-13T04:41:58.979Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ⁄                        %  connectionId    helloOk ismaster 	localTime ñÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 52}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:58.979Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 52 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:41:58.980Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1558065}
read bytes:  197 , err:  <nil>
  the clientConnId:  52


 the mongo msg header:  {197 219 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   €       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  52
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  52
the recieved request:   header: &{197 219 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 219 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 219 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  52  and destConnId:  0
the responseTo for the OpMsg: 219
2023-07-13T04:41:58.981Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 52
an iteration of a mongo request lifecycle is completed
2023-07-13T04:41:58.981Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 52 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 220 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ‹       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 220 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 220 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 220
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:07.925Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 221 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ›       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 221 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 221 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 221
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:17.927Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  52


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:42:18.992Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 52}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:42:18.993Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20014}
2023-07-13T04:42:18.993Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:42:18.995Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:42:18.995Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:42:18.995Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 55638, "Time": 1689223338}
2023-07-13T04:42:18.995Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:42:18.995Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 55638}
read bytes:  317 , err:  <nil>
2023-07-13T04:42:18.995Z	DEBUG	proxy/proxy.go:615	the clientConnId: 56
into processing mongo. clientConnId:  56
into test mode. clientConnId:  56
into decode mongo. clientConnId:  56
2023-07-13T04:42:18.995Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: =  ﬁ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 222 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ﬁ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  56
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{317 222 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  56
2023-07-13T04:42:18.995Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:42:18.995Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223338
2023-07-13T04:42:18.995Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223338"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 222 0 OP_QUERY} clientConnId: 56

2023-07-13T04:42:18.995Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ﬁ                        %  connectionId    helloOk ismaster 	localTime ™ÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 56}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:18.995Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:42:18.996Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1713288}
read bytes:  197 , err:  <nil>
  the clientConnId:  56


 the mongo msg header:  {197 223 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ﬂ       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  56
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{197 223 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 223 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 223 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  56  and destConnId:  0
the responseTo for the OpMsg: 223
2023-07-13T04:42:18.997Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 56
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:18.997Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 224 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ‡       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 224 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 224 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 224
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:27.928Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 225 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ·       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 225 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 225 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 225
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:37.929Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:42:39.016Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  56


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:42:39.017Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 56}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:42:39.017Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:42:39.018Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:42:39.019Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:42:39.019Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:42:39.019Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 54140, "Time": 1689223359}
2023-07-13T04:42:39.019Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:42:39.019Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 54140}
read bytes:  317 , err:  <nil>
2023-07-13T04:42:39.019Z	DEBUG	proxy/proxy.go:615	the clientConnId: 79
into processing mongo. clientConnId:  79
into test mode. clientConnId:  79
into decode mongo. clientConnId:  79
2023-07-13T04:42:39.019Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: =  ‚       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 226 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ‚       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  79
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{317 226 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  79
2023-07-13T04:42:39.020Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:42:39.020Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223359
2023-07-13T04:42:39.020Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223359"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 226 0 OP_QUERY} clientConnId: 79

2023-07-13T04:42:39.020Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ‚                        %  connectionId    helloOk ismaster 	localTime øÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 79}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:39.020Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:42:39.020Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1636067}
read bytes:  197 , err:  <nil>
  the clientConnId:  79


 the mongo msg header:  {197 227 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   „       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  79
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{197 227 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 227 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 227 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  79  and destConnId:  0
the responseTo for the OpMsg: 227
2023-07-13T04:42:39.022Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 79
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:39.022Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 228 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ‰       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 228 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 228 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 228
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:47.930Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 229 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Â       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 229 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 229 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 229
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:57.932Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  79


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:42:59.041Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 79}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:42:59.042Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:42:59.041Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:42:59.044Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:42:59.044Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:42:59.044Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 41964, "Time": 1689223379}
2023-07-13T04:42:59.044Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:42:59.044Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 41964}
read bytes:  317 , err:  <nil>
2023-07-13T04:42:59.044Z	DEBUG	proxy/proxy.go:615	the clientConnId: 79
into processing mongo. clientConnId:  79
into test mode. clientConnId:  79
into decode mongo. clientConnId:  79
2023-07-13T04:42:59.044Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: =  Ê       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 230 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Ê       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  79
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{317 230 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  79
2023-07-13T04:42:59.044Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:42:59.044Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223379
2023-07-13T04:42:59.044Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223379"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 230 0 OP_QUERY} clientConnId: 79

2023-07-13T04:42:59.045Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Ê                        %  connectionId    helloOk ismaster 	localTime ”ÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 79}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:59.045Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:42:59.045Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1749579}
read bytes:  197 , err:  <nil>
  the clientConnId:  79


 the mongo msg header:  {197 231 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   Á       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  79
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{197 231 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 231 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 231 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  79  and destConnId:  0
the responseTo for the OpMsg: 231
2023-07-13T04:42:59.046Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 79
an iteration of a mongo request lifecycle is completed
2023-07-13T04:42:59.046Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 232 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ë       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 232 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 232 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 232
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:07.933Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 233 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   È       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 233 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 233 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 233
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:17.934Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  79


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:43:19.066Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 79}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:43:19.067Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:43:19.066Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:43:19.068Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:43:19.069Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:43:19.069Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:43:19.069Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 47646, "Time": 1689223399}
2023-07-13T04:43:19.069Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:43:19.069Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 47646}
read bytes:  317 , err:  <nil>
2023-07-13T04:43:19.070Z	DEBUG	proxy/proxy.go:615	the clientConnId: 20
into processing mongo. clientConnId:  20
into test mode. clientConnId:  20
into decode mongo. clientConnId:  20
2023-07-13T04:43:19.070Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 20 and destConnId: 0. requestBuffer: =  Í       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 234 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Í       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  20
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  20
the recieved request:   header: &{317 234 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  20
2023-07-13T04:43:19.070Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:43:19.070Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223399
2023-07-13T04:43:19.070Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223399"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 234 0 OP_QUERY} clientConnId: 20

2023-07-13T04:43:19.070Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Í                        %  connectionId    helloOk ismaster 	localTime ÁÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 20}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:19.070Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 20 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:43:19.071Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1586546}
read bytes:  197 , err:  <nil>
  the clientConnId:  20


 the mongo msg header:  {197 235 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   Î       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  20
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  20
the recieved request:   header: &{197 235 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 235 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 235 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  20  and destConnId:  0
the responseTo for the OpMsg: 235
2023-07-13T04:43:19.072Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 20
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:19.072Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 20 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 236 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ï       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 236 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 236 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 236
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:27.935Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 237 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ì       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 237 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 237 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 237
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:37.937Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:43:39.092Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  20


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:43:39.093Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 20}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:43:39.093Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:43:39.094Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:43:39.094Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:43:39.094Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 42738, "Time": 1689223419}
2023-07-13T04:43:39.094Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:43:39.094Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 42738}
read bytes:  317 , err:  <nil>
2023-07-13T04:43:39.094Z	DEBUG	proxy/proxy.go:615	the clientConnId: 69
into processing mongo. clientConnId:  69
into test mode. clientConnId:  69
into decode mongo. clientConnId:  69
2023-07-13T04:43:39.094Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 69 and destConnId: 0. requestBuffer: =  Ó       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 238 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Ó       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  69
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  69
the recieved request:   header: &{317 238 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  69
2023-07-13T04:43:39.094Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:43:39.095Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223419
2023-07-13T04:43:39.095Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223419"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 238 0 OP_QUERY} clientConnId: 69

2023-07-13T04:43:39.095Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Ó                        %  connectionId    helloOk ismaster 	localTime ˚ÄØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 69}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:39.095Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 69 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:43:39.095Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1914161}
read bytes:  197 , err:  <nil>
  the clientConnId:  69


 the mongo msg header:  {197 239 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   Ô       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  69
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  69
the recieved request:   header: &{197 239 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 239 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 239 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  69  and destConnId:  0
the responseTo for the OpMsg: 239
2023-07-13T04:43:39.096Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 69
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:39.096Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 69 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 240 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 240 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 240 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 240
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:47.938Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 241 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ò       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 241 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 241 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 241
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:57.940Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  69


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:43:59.116Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 69}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:43:59.116Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:43:59.116Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:43:59.118Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:43:59.119Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:43:59.119Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:43:59.119Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 51838, "Time": 1689223439}
2023-07-13T04:43:59.119Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:43:59.119Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 51838}
read bytes:  317 , err:  <nil>
2023-07-13T04:43:59.119Z	DEBUG	proxy/proxy.go:615	the clientConnId: 68
into processing mongo. clientConnId:  68
into test mode. clientConnId:  68
into decode mongo. clientConnId:  68
2023-07-13T04:43:59.119Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: =  Ú       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 242 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  Ú       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  68
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  68
the recieved request:   header: &{317 242 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  68
2023-07-13T04:43:59.119Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:43:59.119Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223439
2023-07-13T04:43:59.120Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223439"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 242 0 OP_QUERY} clientConnId: 68

2023-07-13T04:43:59.120Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      Ú                        %  connectionId    helloOk ismaster 	localTime ÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 68}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:59.120Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:43:59.120Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1530695}
read bytes:  197 , err:  <nil>
  the clientConnId:  68


 the mongo msg header:  {197 243 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   Û       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  68
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  68
the recieved request:   header: &{197 243 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 243 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 243 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  68  and destConnId:  0
the responseTo for the OpMsg: 243
2023-07-13T04:43:59.122Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 68
an iteration of a mongo request lifecycle is completed
2023-07-13T04:43:59.122Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 68 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 244 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   Ù       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 244 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 244 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 244
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:07.941Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 245 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ı       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 245 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 245 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 245
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:17.942Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:44:19.139Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  68


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:44:19.140Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:44:19.141Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:44:19.141Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 51270, "Time": 1689223459}
2023-07-13T04:44:19.141Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:44:19.141Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 51270}
read bytes:  317 , err:  <nil>
2023-07-13T04:44:19.141Z	DEBUG	proxy/proxy.go:615	the clientConnId: 25
into processing mongo. clientConnId:  25
into test mode. clientConnId:  25
into decode mongo. clientConnId:  25
2023-07-13T04:44:19.141Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 25 and destConnId: 0. requestBuffer: =  ˆ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 246 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ˆ       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  25
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  25
the recieved request:   header: &{317 246 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  25
2023-07-13T04:44:19.141Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:44:19.140Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 68}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:44:19.141Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223459
2023-07-13T04:44:19.141Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:44:19.141Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223459"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 246 0 OP_QUERY} clientConnId: 25

2023-07-13T04:44:19.141Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ˆ                        %  connectionId    helloOk ismaster 	localTime #ÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 25}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:19.141Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 25 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:44:19.142Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1608297}
read bytes:  197 , err:  <nil>
  the clientConnId:  25


 the mongo msg header:  {197 247 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ˜       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  25
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  25
the recieved request:   header: &{197 247 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 247 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 247 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  25  and destConnId:  0
the responseTo for the OpMsg: 247
2023-07-13T04:44:19.143Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 25
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:19.143Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 25 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 248 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ¯       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 248 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 248 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 248
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:27.943Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 249 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ˘       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 249 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 249 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 249
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:37.944Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  25


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:44:39.163Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 25}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:44:39.163Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:44:39.163Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:44:39.164Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:44:39.165Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:44:39.165Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:44:39.165Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 54282, "Time": 1689223479}
2023-07-13T04:44:39.165Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:44:39.165Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 54282}
read bytes:  317 , err:  <nil>
2023-07-13T04:44:39.165Z	DEBUG	proxy/proxy.go:615	the clientConnId: 98
into processing mongo. clientConnId:  98
into test mode. clientConnId:  98
into decode mongo. clientConnId:  98
2023-07-13T04:44:39.165Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 98 and destConnId: 0. requestBuffer: =  ˙       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 250 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ˙       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  98
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  98
the recieved request:   header: &{317 250 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  98
2023-07-13T04:44:39.165Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:44:39.166Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223479
2023-07-13T04:44:39.166Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223479"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 250 0 OP_QUERY} clientConnId: 98

2023-07-13T04:44:39.166Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ˙                        %  connectionId    helloOk ismaster 	localTime 7ÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 98}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:39.166Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 98 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:44:39.167Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1459154}
read bytes:  197 , err:  <nil>
  the clientConnId:  98


 the mongo msg header:  {197 251 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ˚       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  98
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  98
the recieved request:   header: &{197 251 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 251 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 251 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  98  and destConnId:  0
the responseTo for the OpMsg: 251
2023-07-13T04:44:39.168Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 98
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:39.168Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 98 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 252 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ¸       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 252 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 252 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 252
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:47.946Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 253 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   ˝       ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 253 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 253 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 253
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:57.948Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  98


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:44:59.187Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 98}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:44:59.187Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20021}
2023-07-13T04:44:59.187Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:44:59.189Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:44:59.189Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:44:59.189Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 32872, "Time": 1689223499}
2023-07-13T04:44:59.189Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:44:59.189Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 32872}
read bytes:  317 , err:  <nil>
2023-07-13T04:44:59.189Z	DEBUG	proxy/proxy.go:615	the clientConnId: 79
into processing mongo. clientConnId:  79
into test mode. clientConnId:  79
into decode mongo. clientConnId:  79
2023-07-13T04:44:59.189Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: =  ˛       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 254 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  ˛       ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  79
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{317 254 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  79
2023-07-13T04:44:59.190Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:44:59.190Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223499
2023-07-13T04:44:59.190Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223499"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 254 0 OP_QUERY} clientConnId: 79

2023-07-13T04:44:59.190Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      ˛                        %  connectionId    helloOk ismaster 	localTime KÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 79}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:59.190Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:44:59.191Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2228127}
read bytes:  197 , err:  <nil>
  the clientConnId:  79


 the mongo msg header:  {197 255 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈   ˇ       ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  79
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  79
the recieved request:   header: &{197 255 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 255 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 255 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  79  and destConnId:  0
the responseTo for the OpMsg: 255
2023-07-13T04:44:59.193Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 79
an iteration of a mongo request lifecycle is completed
2023-07-13T04:44:59.193Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 79 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 256 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4          ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 256 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 256 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 256
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:07.949Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 257 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 257 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 257 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 257
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:17.951Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  79


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:45:19.211Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 79}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:45:19.211Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20022}
2023-07-13T04:45:19.211Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:45:19.212Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:45:19.213Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:45:19.213Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:45:19.213Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:45:19.213Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:45:19.213Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:45:19.213Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:45:19.213Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:45:19.214Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:45:19.214Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:45:19.214Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 41184, "Time": 1689223519}
2023-07-13T04:45:19.214Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:45:19.214Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 41184}
read bytes:  317 , err:  <nil>
2023-07-13T04:45:19.214Z	DEBUG	proxy/proxy.go:615	the clientConnId: 73
into processing mongo. clientConnId:  73
into test mode. clientConnId:  73
into decode mongo. clientConnId:  73
2023-07-13T04:45:19.214Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 73 and destConnId: 0. requestBuffer: =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 258 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  73
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  73
the recieved request:   header: &{317 258 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  73
2023-07-13T04:45:19.215Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:45:19.215Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223519
2023-07-13T04:45:19.215Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223519"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 258 0 OP_QUERY} clientConnId: 73

2023-07-13T04:45:19.215Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime _ÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 73}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:19.215Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 73 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:45:19.216Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2111695}
read bytes:  197 , err:  <nil>
  the clientConnId:  73


 the mongo msg header:  {197 259 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈         ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  73
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  73
the recieved request:   header: &{197 259 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 259 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 259 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  73  and destConnId:  0
the responseTo for the OpMsg: 259
2023-07-13T04:45:19.217Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 73
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:19.217Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 73 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 260 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 260 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 260 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 260
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:27.952Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 261 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 261 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 261 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 261
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:37.953Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:45:39.237Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

read bytes:  0 , err:  EOF
  the clientConnId:  73


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:45:39.238Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 73}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:45:39.239Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-13T04:45:39.239Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:45:39.239Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:45:39.239Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 45226, "Time": 1689223539}
2023-07-13T04:45:39.240Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:45:39.240Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 45226}
read bytes:  317 , err:  <nil>
2023-07-13T04:45:39.240Z	DEBUG	proxy/proxy.go:615	the clientConnId: 41
into processing mongo. clientConnId:  41
into test mode. clientConnId:  41
into decode mongo. clientConnId:  41
2023-07-13T04:45:39.240Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 262 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  41
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{317 262 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  41
2023-07-13T04:45:39.240Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:45:39.240Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223539
2023-07-13T04:45:39.240Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223539"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 262 0 OP_QUERY} clientConnId: 41

2023-07-13T04:45:39.240Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime sÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 41}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:39.240Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:45:39.241Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1906852}
read bytes:  197 , err:  <nil>
  the clientConnId:  41


 the mongo msg header:  {197 263 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈         ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  41
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  41
the recieved request:   header: &{197 263 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 263 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 263 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  41  and destConnId:  0
the responseTo for the OpMsg: 263
2023-07-13T04:45:39.242Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 41
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:39.242Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 41 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 264 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 264 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 264 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 264
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:47.954Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 265 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4   	      ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 265 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 265 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 265
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:57.956Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  41


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:45:59.261Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 41}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:45:59.261Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20021}
2023-07-13T04:45:59.261Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:45:59.263Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:45:59.264Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:45:59.264Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:45:59.264Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 52848, "Time": 1689223559}
2023-07-13T04:45:59.264Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:45:59.264Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 52848}
read bytes:  317 , err:  <nil>
2023-07-13T04:45:59.265Z	DEBUG	proxy/proxy.go:615	the clientConnId: 11
into processing mongo. clientConnId:  11
into test mode. clientConnId:  11
into decode mongo. clientConnId:  11
2023-07-13T04:45:59.265Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 11 and destConnId: 0. requestBuffer: =  
      ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 266 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =  
      ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  11
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  11
the recieved request:   header: &{317 266 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  11
2023-07-13T04:45:59.265Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:45:59.265Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223559
2023-07-13T04:45:59.265Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223559"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 266 0 OP_QUERY} clientConnId: 11

2023-07-13T04:45:59.265Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I      
                       %  connectionId    helloOk ismaster 	localTime áÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 11}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:59.266Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 11 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:45:59.266Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=2022713}
read bytes:  197 , err:  <nil>
  the clientConnId:  11


 the mongo msg header:  {197 267 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈         ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  11
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  11
the recieved request:   header: &{197 267 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 267 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 267 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  11  and destConnId:  0
the responseTo for the OpMsg: 267
2023-07-13T04:45:59.267Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 11
an iteration of a mongo request lifecycle is completed
2023-07-13T04:45:59.267Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 11 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 268 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 268 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 268 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 268
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:07.957Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 269 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 269 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 269 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 269
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:17.958Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  11


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:46:19.287Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 11}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:46:19.287Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20023}
2023-07-13T04:46:19.287Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:46:19.292Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:46:19.292Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:46:19.292Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 53782, "Time": 1689223579}
2023-07-13T04:46:19.292Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:46:19.292Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 53782}
read bytes:  317 , err:  <nil>
2023-07-13T04:46:19.292Z	DEBUG	proxy/proxy.go:615	the clientConnId: 56
into processing mongo. clientConnId:  56
into test mode. clientConnId:  56
into decode mongo. clientConnId:  56
2023-07-13T04:46:19.292Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 270 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  56
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{317 270 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  56
2023-07-13T04:46:19.292Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:46:19.292Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223579
2023-07-13T04:46:19.293Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223579"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 270 0 OP_QUERY} clientConnId: 56

2023-07-13T04:46:19.293Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime õÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 56}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:19.293Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:46:19.293Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1562846}
read bytes:  197 , err:  <nil>
  the clientConnId:  56


 the mongo msg header:  {197 271 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈         ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  56
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  56
the recieved request:   header: &{197 271 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 271 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 271 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  56  and destConnId:  0
the responseTo for the OpMsg: 271
2023-07-13T04:46:19.296Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 56
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:19.296Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 56 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 272 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 272 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 272 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 272
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:27.960Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 273 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 273 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 273 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 273
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:37.961Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
read bytes:  0 , err:  EOF
  the clientConnId:  56


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:46:39.316Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 56}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:46:39.316Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 20024}
2023-07-13T04:46:39.316Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server mongodb:27017

com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:718) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:599) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:440) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:397) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:227) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:159) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:350) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:803) ~[na:na]
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966) ~[na:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:113) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:138) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:735) ~[mongodb-driver-core-4.9.1.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.receiveMessageWithAdditionalTimeout(InternalStreamConnection.java:596) ~[mongodb-driver-core-4.9.1.jar!/:na]
	... 5 common frames omitted

2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "mongodb.ap-south-1.compute.internal."}
2023-07-13T04:46:39.318Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:46:39.319Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:46:39.319Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:46:39.319Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 44956, "Time": 1689223599}
2023-07-13T04:46:39.319Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,65535,2887718541], "DestPort": 27017, "KernelPid": 247283}
2023-07-13T04:46:39.319Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 44956}
read bytes:  317 , err:  <nil>
2023-07-13T04:46:39.319Z	DEBUG	proxy/proxy.go:615	the clientConnId: 58
into processing mongo. clientConnId:  58
into test mode. clientConnId:  58
into decode mongo. clientConnId:  58
2023-07-13T04:46:39.319Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 58 and destConnId: 0. requestBuffer: =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2   


 the mongo msg header:  {317 274 0 OP_QUERY} 
 
the opcode matche query. msgheader opcode:  OP_QUERY the opcode for query:  OP_QUERY
the decoded string for the wiremessage:  { OpQuery flags: [], fullCollectionName: admin.$cmd, numberToSkip: 0, numberToReturn: -1, query: {"isMaster": {"$numberInt":"1"},"helloOk": true,"client": {"driver": {"name": "mongo-java-driver|sync|spring-boot","version": "4.9.1"},"os": {"type": "Linux","name": "Linux","architecture": "amd64","version": "5.19.0-1028-aws"},"platform": "Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2"}}, returnFieldsSelector:  }
the request buffer:  =        ‘      admin.$cmd     ˇˇˇˇ  isMaster    helloOk client Ò   driver E   name #   mongo-java-driver|sync|spring-boot version    4.9.1  os Z   type    Linux name    Linux architecture    amd64 version    5.19.0-1028-aws  platform 3   Java/Private Build/17.0.7+7-Ubuntu-0ubuntu122.04.2     clientConnId:  58
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  58
the recieved request:   header: &{317 274 0 OP_QUERY}  
the expected request:   header: &{317 2 0 OP_QUERY}
the request query matches. clientconnid:  58
2023-07-13T04:46:39.320Z	DEBUG	mongoparser/mongoparser.go:425	the document string is: {"helloOk":true,"ismaster":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxBsonObjectSize":{"$numberInt":"16777216"},"maxMessageSizeBytes":{"$numberInt":"48000000"},"maxWriteBatchSize":{"$numberInt":"100000"},"localTime":{"$date":{"$numberLong":"1689163831091"}},"logicalSessionTimeoutMinutes":{"$numberInt":"30"},"connectionId":{"$numberInt":"5"},"minWireVersion":{"$numberInt":"0"},"maxWireVersion":{"$numberInt":"17"},"readOnly":false,"ok":{"$numberDouble":"1.0"}}
2023-07-13T04:46:39.320Z	DEBUG	mongoparser/mongoparser.go:439	the updated document string is: 1689223599
2023-07-13T04:46:39.320Z	DEBUG	mongoparser/mongoparser.go:462	the elements of the reply docs: ["connectionId": {"$numberInt":"5"} "helloOk": true "ismaster": true "localTime": {"$date":{"$numberLong":"1689223599"}} "logicalSessionTimeoutMinutes": {"$numberInt":"30"} "maxBsonObjectSize": {"$numberInt":"16777216"} "maxMessageSizeBytes": {"$numberInt":"48000000"} "maxWireVersion": {"$numberInt":"17"} "maxWriteBatchSize": {"$numberInt":"100000"} "minWireVersion": {"$numberInt":"0"} "ok": {"$numberDouble":"1.0"} "readOnly": false "topologyVersion": {"counter": {"$numberLong":"0"},"processId": {"$oid":"64ae95896fd24207cd4845a1"}}]
the index of recived request: 0. And the request header: &{317 274 0 OP_QUERY} clientConnId: 58

2023-07-13T04:46:39.320Z	DEBUG	mongoparser/mongoparser.go:498	the bufffer response is: I                             %  connectionId    helloOk ismaster 	localTime ØÅØd    logicalSessionTimeoutMinutes    maxBsonObjectSize    maxMessageSizeBytes  l‹maxWireVersion    maxWriteBatchSize †Ü minWireVersion     ok       ?readOnly  topologyVersion -   counter         processId dÆïâo“BÕHE°  	{"clientconnid": 58}
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:39.320Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 58 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:46:39.320Z  INFO 247283 --- [}-mongodb:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=mongodb:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=1724218}
read bytes:  197 , err:  <nil>
  the clientConnId:  58


 the mongo msg header:  {197 275 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request buffer:  ≈         ›      ∞   hello    helloOk topologyVersion -   processId dÆïâo“BÕHE°counter          maxAwaitTimeMS '      $db    admin $readPreference     mode    primaryPreferred     clientConnId:  58
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 65536, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"helloOk":true,"topologyVersion":{"processId":{"$oid":"64ae95896fd24207cd4845a1"},"counter":{"$numberLong":"0"}},"maxAwaitTimeMS":{"$numberLong":"10000"},"$db":"admin","$readPreference":{"mode":"primaryPreferred"}} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  58
the recieved request:   header: &{197 275 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{197 275 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the recieved request:   header: &{197 275 0 OP_MSG}  
the expected request:   header: &{197 3 0 OP_MSG}
the response cycle. delay:  10129642907  time.duration:  10.129642907s  for clientConnId:  58  and destConnId:  0
the responseTo for the OpMsg: 275
2023-07-13T04:46:39.321Z	DEBUG	mongoparser/mongoparser.go:593	the response lifecycle ended. clientconnid: 58
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:39.321Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 58 and destConnId: 0. requestBuffer: read form client connection
read bytes:  52 , err:  <nil>
  the clientConnId:  70


 the mongo msg header:  {52 276 0 OP_MSG} 
 
the opcode matche msg. msgheader opcode:  OP_MSG the opcode for msg:  OP_MSG
the decoded string for the wiremessage:  { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request buffer:  4         ›          hello    $db    admin    clientConnId:  70
check that the opmsg is heartbeat or not. operation: { OpMsg flags: 0, sections: [{ SectionSingle msg: {"hello":{"$numberInt":"1"},"$db":"admin"} }], checksum: 0 }
the request opmg is isMaster? : true 
recieved a heartbeat call. Recieved requests:  len: 1  clientconnid:  70
the recieved request:   header: &{52 276 0 OP_MSG}  
the expected request:   header: &{317 2 0 OP_QUERY}
the recieved request:   header: &{52 276 0 OP_MSG}  
the expected request:   header: &{52 4 0 OP_MSG}
the responseTo for the OpMsg: 276
an iteration of a mongo request lifecycle is completed
2023-07-13T04:46:47.962Z	DEBUG	mongoparser/mongoparser.go:327	the lopp starts for clientConnId: 70 and destConnId: 0. requestBuffer: read form client connection
2023-07-13T04:46:49.955Z	DEBUG	proxy/proxy.go:564	üê∞ Keploy:	{"PID in proxy:": 246469}
2023-07-13T04:46:49.955Z	DEBUG	proxy/proxy.go:565	üê∞ Keploy:	{"Filtering in Proxy": true}
2023-07-13T04:46:49.955Z	DEBUG	proxy/proxy.go:572	üê∞ Keploy:Inside handleConnection of proxyServer	{"source port": 37758, "Time": 1689223609}
2023-07-13T04:46:49.955Z	DEBUG	proxy/proxy.go:589	üê∞ Keploy:	{"DestIp6": [0,0,0,1], "DestPort": 8080, "KernelPid": 247283}
2023-07-13T04:46:49.955Z	DEBUG	hooks/loader.go:209	üê∞ Keploy:successfully removed entry from redirect proxy map	{"(Key)/SourcePort": 37758}
read bytes:  0 , err:  read tcp [::1]:16789->[::1]:37758: read: connection reset by peer
2023-07-13T04:46:49.955Z	DEBUG	proxy/proxy.go:615	the clientConnId: 71
2023-07-13T04:46:49.955Z	ERROR	proxy/proxy.go:618	üê∞ Keploy:failed to read the request message in proxy	{"error": "read tcp [::1]:16789->[::1]:37758: read: connection reset by peer", "proxy port": 16789}
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:618
read bytes:  0 , err:  EOF
  the clientConnId:  58


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:46:50.976Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 58}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:46:50.976Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 11656}
read bytes:  0 , err:  EOF
  the clientConnId:  70


 the mongo msg header:  {0 0 0 <invalid opcode>} 
 
2023-07-13T04:46:50.976Z	ERROR	mongoparser/mongoparser.go:349	üê∞ Keploy:failed to decode the mongo wire message from the client	{"error": "malformed wire message: insufficient bytes", "clientConnId": 70}
go.keploy.io/server/pkg/proxy/integrations/mongoparser.decodeOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:349
go.keploy.io/server/pkg/proxy/integrations/mongoparser.ProcessOutgoingMongo
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/integrations/mongoparser/mongoparser.go:49
go.keploy.io/server/pkg/proxy.(*ProxySet).handleConnection
	/home/ubuntu/keploy-v2/keploy/pkg/proxy/proxy.go:708
2023-07-13T04:46:50.976Z	DEBUG	proxy/proxy.go:733	üê∞ Keploy:time taken by proxy to execute the flow	{"Duration(ms)": 1373263}
2023-07-13T04:46:55.797Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:46:55.797Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:46:55.797Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:46:55.798Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:46:55.798Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:46:55.798Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:46:55.798Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:46:55.798Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:46:55.798Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:46:56.798Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup ip-172-31-22-141.ap-south-1.compute.internal: i/o timeout"}
2023-07-13T04:46:56.798Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:46:56.798Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:46:56.798Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup ip-172-31-22-141.ap-south-1.compute.internal: i/o timeout"}
2023-07-13T04:46:56.798Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:46:56.798Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:46:56.799Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup ip-172-31-22-141.ap-south-1.compute.internal: i/o timeout"}
2023-07-13T04:46:56.799Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:46:56.799Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:47:03.354Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:17.812Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:17.812Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:47:17.812Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:47:17.812Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:17.812Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:17.813Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:47:17.813Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:47:17.813Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:17.865Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:17.865Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 12}
2023-07-13T04:47:17.865Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "141.22.31.172.in-addr.arpa."}
2023-07-13T04:47:17.866Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:17.866Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:47:17.866Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "141.22.31.172.in-addr.arpa."}
2023-07-13T04:47:18.866Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup 141.22.31.172.in-addr.arpa: i/o timeout"}
2023-07-13T04:47:18.867Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:47:18.867Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:18.866Z	DEBUG	proxy/proxy.go:475	üê∞ Keploy:failed to resolve the dns query	{"error": "lookup 141.22.31.172.in-addr.arpa: i/o timeout"}
2023-07-13T04:47:18.867Z	DEBUG	proxy/proxy.go:437	üê∞ Keploy:failed to resolve dns query hence sending proxy ip	{"proxy Ip": "172.31.22.141"}
2023-07-13T04:47:18.867Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 1}
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:401	üê∞ Keploy:Got some Dns queries
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:403	üê∞ Keploy:	{"Record Type": 28}
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:404	üê∞ Keploy:	{"Received Query": "ip-172-31-22-141.ap-south-1.compute.internal."}
2023-07-13T04:47:27.827Z	DEBUG	proxy/proxy.go:454	üê∞ Keploy:Writing dns info back to the client...
